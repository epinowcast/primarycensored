<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Why it works • primarycensored</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Why it works">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">primarycensored</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/primarycensored.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reference" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reference</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reference">
<li><a class="dropdown-item" href="../reference/index.html">R reference</a></li>
    <li><a class="dropdown-item" href="https://primarycensored.epinowcast.org/stan/">Stan reference</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>──── First steps ────</h6></li>
    <li><a class="dropdown-item" href="../articles/primarycensored.html">Getting started</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>──── Methodology ────</h6></li>
    <li><a class="dropdown-item" href="../articles/why-it-works.html">Why it works</a></li>
    <li><a class="dropdown-item" href="../articles/analytic-solutions.html">Analytic solutions for censored delay distributions</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>──── Fitting delay distributions ────</h6></li>
    <li><a class="dropdown-item" href="../articles/fitting-dists-with-stan.html">Fitting distributions using primarycensored and cmdstan</a></li>
    <li><a class="dropdown-item" href="../articles/fitting-dists-with-fitdistrplus.html">Fitting distributions using primarycensored and fitdistrplus</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>──── Stan development ────</h6></li>
    <li><a class="dropdown-item" href="../articles/using-stan-tools.html">How to use primarycensored with Stan</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epinowcast/primarycensored/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Why it works</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/primarycensored/blob/main/vignettes/why-it-works.Rmd" class="external-link"><code>vignettes/why-it-works.Rmd</code></a></small>
      <div class="d-none name"><code>why-it-works.Rmd</code></div>
    </div>

    
    
<div class="section level2" number="1">
<h2 id="introduction">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3" number="1.1">
<h3 id="what-are-we-going-to-do-in-this-vignette">
<span class="header-section-number">1.1</span> What are we going to do in this vignette<a class="anchor" aria-label="anchor" href="#what-are-we-going-to-do-in-this-vignette"></a>
</h3>
<p>In this vignette, we’ll explain the statistical model that the <code>primarycensored</code> package is based on. We’ll cover the following key points:</p>
<ol style="list-style-type: decimal">
<li>Introduction to the censored data problems in time to event analysis.</li>
<li>Discuss the relevant issues from censoring in epidemiological data.</li>
<li>Introduce the statistical model used in <code>primarycensored</code>.</li>
<li>Distributions where we can derive the censored delay distribution analytically.</li>
</ol>
<p>If you are new to the package, we recommend that you start with the <code><a href="../articles/primarycensored.html">vignette("primarycensored")</a></code> vignette.</p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="censoring-and-right-truncation-problems-in-time-to-event-analysis">
<span class="header-section-number">2</span> Censoring and right truncation problems in time to event analysis<a class="anchor" aria-label="anchor" href="#censoring-and-right-truncation-problems-in-time-to-event-analysis"></a>
</h2>
<p>Time-to-event analysis, also known as survival analysis, concerns estimating the distribution of delay times between events. A distinctive feature of the field are the methodological techniques used to deal with the missing data problems common in data sets of delay times<span class="citation"><sup>[<a href="#ref-leung1997censoring">1</a>]</sup></span>. In <code>primarycensored</code> we focus on two particular missing data problems:</p>
<ul>
<li>
<strong>Interval censoring</strong>. The primary (start) time and/or the secondary (end) time of the delay are unobserved but both are known to be within intervals.</li>
<li>
<strong>Right truncation</strong>. Truncated delay data items are only reported if their secondary events are less than a known time, for example the current data collection time.</li>
</ul>
<p>In statistical epidemiology, these missing data problems occur frequently in both data analysis and theoretical modelling. For a more detailed description of these problems in an epidemiological context see<span class="citation"><sup>[<a href="#ref-Park2024">2</a>,<a href="#ref-Charniga2024">3</a>]</sup></span>.</p>
<div class="alert alert-info">
<p><strong>For data analysis</strong>: In epidemiology, events are commonly reported as occurring on a particular day or week. This means that <em>both</em> events that define a delay are interval censored. In an emerging outbreak, datasets can also be incompletely observed (<em>right truncation</em>). <code>primarycensored</code> provides statistically rigorous methods to account for this double censoring and truncation.</p>
<p><strong>For theoretical modelling</strong>: Discrete-time models (e.g., <a href="https://epiforecasts.io/EpiNow2/" class="external-link"><code>EpiNow2</code></a>, <a href="https://mrc-ide.github.io/EpiEstim/index.html" class="external-link"><code>EpiEstim</code></a>) implicitly treat both events as interval censored at the model’s timestep. <code>primarycensored</code> provides a principled approach to discretising continuous distributions that accounts for this.</p>
</div>
</div>
<div class="section level2" number="3">
<h2 id="statistical-model-used-in-primarycensored">
<span class="header-section-number">3</span> Statistical model used in <code>primarycensored</code><a class="anchor" aria-label="anchor" href="#statistical-model-used-in-primarycensored"></a>
</h2>
<p>As described in <a href="primarycensored.html">Getting started with <code>primarycensored</code></a>, <code>primarycensored</code> focuses on a subset of methods from time to event analysis that address data missingness problems commonly found in epidemiological datasets. We present the statistical problem as a double interval censoring problem, where both the primary event time and the secondary event times are interval censored. We can recover single interval censoring problems by reducing one of the intervals to a point. In particular, all of the methods in <code>primarycensored</code> start by assuming no secondary event censoring and solving the primary censoring problem. This is the reason for the packages name despite the most common use case being when there is double censoring. A key assumption we make throughout is that the censoring window for events are known and independent of the event time within the censoring interval. This is known as non-informative censoring.</p>
<p>The target for inference is the distribution of the delay time between the primary and secondary events. We assume that the delay time is a random variable <span class="math inline">\(T = S - P_{u}\)</span> with distribution function <span class="math inline">\(F_T(t) = Pr(T &lt; t)\)</span> and density function <span class="math inline">\(f_T(t)\)</span>. In this treatment we assume that the delay time is shift-invariant, that is, the distribution of the delay time is the same regardless of the primary event time.</p>
<p>The (unconditional) primary event time is a random variable <span class="math inline">\(P_{u}\)</span> with distribution function <span class="math inline">\(F_{P_{u}}(t)\)</span> and density function <span class="math inline">\(f_{P_{u}}(t)\)</span>. The secondary event time is a random variable <span class="math inline">\(S\)</span>, but in this treatment we construct the secondary event time from the primary time and delay, therefore the marginal distribution of <span class="math inline">\(S\)</span> is not considered.</p>
<p>The <em>censoring window</em> for each event is the interval within which each event is known to have occurred, respectively, <span class="math inline">\(P \in [t_P, t_P + w_P]\)</span> and <span class="math inline">\(S \in [t_S, t_S + w_S]\)</span>. The lengths of the censoring windows are <span class="math inline">\(w_P\)</span> and <span class="math inline">\(w_S\)</span> respectively. The precise event times within their windows are unobserved. Note that since the primary event time is known up to the censoring window, we are predominantly interested in the <em>conditional</em> primary time <span class="math inline">\(P = P_{u} | \{ P_{u} \in [t_P, t_P + w_P]\}\)</span> which has density function:</p>
<p><span class="math display">\[
\begin{aligned}
f_{P}(p) &amp;= {f_{P_{u}}(p) \over F_{P_{u}}(t_P + w_P) - F_{P_{u}}(t_P)}, \qquad &amp;p \in [t_P, t_P + w_P],\\
f_{P}(p) &amp;= 0, \qquad &amp;\text{otherwise}.
\end{aligned}
\]</span></p>
<p>In this note, we measure the <em>censored delay time</em> <span class="math inline">\(T_c\)</span> between the primary and secondary event windows from endpoint to endpoint: <span class="math inline">\(T_c = t_S + w_S - (t_P + w_P)\)</span>. Note that in the <a href="primarycensored.html#generating-random-samples-with-rprimarycensored">generative model for delays</a> from “Getting started” the truncated delay <span class="math inline">\(t_{\text{valid}}\)</span> is measured from startpoint to startpoint of event windows.</p>
<p>In our treatment below we focus on the <a href="https://en.wikipedia.org/wiki/Survival_function" class="external-link">survival function</a> of the time after the end of the primary window to the secondary event time which we denote <span class="math inline">\(S_{+}\)</span>. We then use this to derive the distribution of the censored delay time <span class="math inline">\(T_c\)</span>. This is equivalent to, but differs in mathematical approach from other treatments of the censoring problems in epidemiology, such as<span class="citation"><sup>[<a href="#ref-Park2024">2</a>]</sup></span>, see section <a href="#connections-to-other-approaches">Connections to other approaches</a> for details.</p>
<div class="section level3" number="3.1">
<h3 id="censored-delay-time-distribution">
<span class="header-section-number">3.1</span> Censored delay time distribution<a class="anchor" aria-label="anchor" href="#censored-delay-time-distribution"></a>
</h3>
<p>In this section, we explain how to derive the distribution of the censored delay time <span class="math inline">\(T_c\)</span> from the distribution of the delay time <span class="math inline">\(T\)</span> and the condition distribution of the primary event time <span class="math inline">\(P\)</span>.</p>
<div class="section level4" number="3.1.1">
<h4 id="survival-function-of-time-from-the-end-of-the-primary-censoring-window-to-the-secondary-event-time">
<span class="header-section-number">3.1.1</span> Survival function of time from the end of the primary censoring window to the secondary event time<a class="anchor" aria-label="anchor" href="#survival-function-of-time-from-the-end-of-the-primary-censoring-window-to-the-secondary-event-time"></a>
</h4>
<p>When reasoning about the distribution of the censored delay time <span class="math inline">\(T_c\)</span>, it is useful to consider the time from the end (right) point of the primary censoring interval to the secondary time as a random variable,</p>
<p><span class="math display">\[
S_+ = S - (t_P + w_P) = T - ((t_P + w_P) - P) = T - C_P.
\]</span></p>
<p>Where <span class="math inline">\(T\)</span> is the delay distribution of interest and <span class="math inline">\(C_P = (t_P + w_P) - P\)</span> is interval between the end (right) point of the primary censoring window and the primary event time; note that by definition <span class="math inline">\(C_P\)</span> is not observed but we can relate its distribution to the distribution of <span class="math inline">\(P\)</span>: <span class="math inline">\(F_{C_P}(p) = Pr(C_P &lt; p) = Pr(P &gt; t_P + w_P - p)\)</span>.</p>
<p>With non-informative censoring, it is possible to derive the upper distribution function of <span class="math inline">\(S_+\)</span>, or <a href="https://en.wikipedia.org/wiki/Survival_function" class="external-link"><em>survival function</em></a> of <span class="math inline">\(S_+\)</span>, from the distribution of <span class="math inline">\(T\)</span> and the distribution of <span class="math inline">\(C_P\)</span>.</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
Q_{S_+}(t) &amp;= Pr(S_+ &gt; t) \\
&amp;= Pr(T &gt; C_P + t) \\
&amp;= \mathbb{E}_{C_P} \Big[Q_T(t + C_P)\Big] \\
&amp;= \int_0^{w_P} Q_T(t + p) f_{C_P}(p) dp.
\end{split}
\end{equation}
\]</span></p>
<p>Using <a href="https://en.wikipedia.org/wiki/Integration_by_parts" class="external-link">integration by parts</a> gives:
<span class="math display" id="eq:survivalfunc">\[
Q_{S_+}(t) = Q_T(t + w_P) + \int_0^{w_P} f_T(t+p) F_{C_P}(p) dp. \tag{3.1}
\]</span></p>
<p>Where we have used that <span class="math inline">\(Q^{'}_{T} = - f_T\)</span>, <span class="math inline">\(Q_T\)</span> is the survival function of the actual delay distribution of interest and <span class="math inline">\(w_P\)</span> is the length of the primary censoring window.</p>
<p>Equation <a href="#eq:survivalfunc">(3.1)</a> is the key equation in this note and is used to derive the distribution of the censored delay time <span class="math inline">\(T_c\)</span>. It has the interpretation that the probability that the secondary event time is greater than <span class="math inline">\(t\)</span> after the end of the primary censoring window is the sum of two disjoint event probabilities:</p>
<ol style="list-style-type: decimal">
<li>The probability that the <em>actual</em> delay time <span class="math inline">\(T\)</span> is greater than <span class="math inline">\(t + w_P\)</span>.</li>
<li>The probability that the <em>actual</em> delay time <span class="math inline">\(T\)</span> is between <span class="math inline">\(t\)</span> and <span class="math inline">\(t + w_P\)</span>, and the primary event time <span class="math inline">\(P\)</span> occurred sufficiently close to the end of the primary censoring window that the secondary even occurred more than time <span class="math inline">\(t\)</span> after the end of the primary window.</li>
</ol>
<p>Note that in <a href="primarycensored.html#compute-the-primary-event-censored-cumulative-distribution-function-cdf-for-delays-with-pprimarycensored">“Getting started”</a> the target for numerical quadrature is the cumulative distribution function of the sum of the primary time within the primary censoring window and the delay time.</p>
</div>
<div class="section level4" number="3.1.2">
<h4 id="probability-of-secondary-event-time-within-a-secondary-censoring-window">
<span class="header-section-number">3.1.2</span> Probability of secondary event time within a secondary censoring window<a class="anchor" aria-label="anchor" href="#probability-of-secondary-event-time-within-a-secondary-censoring-window"></a>
</h4>
<p>Having constructed the survival function of <span class="math inline">\(S_+\)</span> with equation <a href="#eq:survivalfunc">(3.1)</a>, using numerical quadrature or in some other way, we can calculate the probability mass of a secondary event time falling within a observed secondary censoring window of length <span class="math inline">\(w_S\)</span> that begins at time <span class="math inline">\(n - w_S\)</span> <em>after</em> the primary censoring window. This is the probability that the censored delay time <span class="math inline">\(T_c\)</span> is <span class="math inline">\(n\)</span>.</p>
<p>This gives the censored delay time probability <a href="https://mc-stan.org/docs/stan-users-guide/truncation-censoring.html#integrating-out-censored-values" class="external-link">by integrating over censored values</a>:</p>
<p><span class="math display" id="eq:seccensorprob">\[
Pr(S_+ \in [n - w_S, n)) = Q_{S_+}(n-w_S) - Q_{S_+}(n). \tag{3.2}
\]</span></p>
<p>Note that the censored secondary event time can also occur within the primary censoring window. This happens with probability,
<span class="math display">\[
Q_{S_+}(-w_P) - Q_{S_+}(0) = 1 - Q_T(w_P) - \int_0^{w_P} f_T(p) F_{C_P}(p) dp = Pr(T&lt; C).
\]</span></p>
</div>
</div>
</div>
<div class="section level2" number="4">
<h2 id="connections-to-other-approaches">
<span class="header-section-number">4</span> Connections to other approaches<a class="anchor" aria-label="anchor" href="#connections-to-other-approaches"></a>
</h2>
<p>In this section, we discuss how the approach taken in <code>primarycensored</code> relates to some other approaches to the censored data problems in time to event analysis.</p>
<div class="section level3" number="4.1">
<h3 id="connection-to-park-et-al-2024">
<span class="header-section-number">4.1</span> Connection to Park et al 2024<a class="anchor" aria-label="anchor" href="#connection-to-park-et-al-2024"></a>
</h3>
<p>Using the notation from the methods overview given in Park et al<span class="citation"><sup>[<a href="#ref-Park2024">2</a>]</sup></span>, we write the conditional probability of the secondary event time <span class="math inline">\(S\in (S_L,S_R)\)</span> given the primary event time <span class="math inline">\(P \in (P_L,P_R)\)</span> as:</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{Pr}(S_L &lt; S &lt; S_R | P_L &lt; P &lt; P_R) &amp;= \frac{\mathrm{Pr}(P_L &lt; P &lt; P_R, S_L &lt; S &lt; S_R)}{\mathrm{Pr}(P_L &lt; P &lt; P_R)} \\
   &amp;= \frac{\int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x) f_x(y-x) dy dx}{\int_{P_L}^{P_R} g_P(x) dx}\\
   &amp;= \int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x|P_L, P_R) f_x(y-x)dy dx
\end{aligned}
\]</span></p>
<p>In this note, we assume that the forward distribution doesn’t vary over time (such that <span class="math inline">\(f_x = f\)</span>), then</p>
<p><span class="math display">\[
\int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x|P_L, P_R) f_x(y-x)dy dx = \int_{P_L}^{P_R} g_P(x|P_L, P_R) \big[F(S_R - x) - F(S_L - x)\big] dx
\]</span></p>
<p>Then, by using integration by parts, we get:</p>
<p><span class="math display" id="eq:park">\[
\begin{split}
\int_{P_L}^{P_R} g_P(x|P_L, P_R) \big[F(S_R - x) - F(S_L - x)\big] dx &amp;=
F(S_R - P_R) - F(S_L - P_R)  \\ &amp; - \int_{P_L}^{P_R} G_P(x|P_L, P_R) \big[f(S_L - x) - f(S_R - x)\big] dx
\end{split} \tag{4.1}
\]</span>
Where we have used that <span class="math inline">\(\partial_x F(S_R - x) = - f(S_R - x)\)</span> and <span class="math inline">\(\partial_x F(S_L - x) = - f(S_L - x)\)</span>.</p>
<p>We can now compare this to equation <a href="#eq:seccensorprob">(3.2)</a> by considering the following transformations:</p>
<ul>
<li>
<span class="math inline">\(P_L = -w_P\)</span> and <span class="math inline">\(P_R = 0\)</span>, this in this note we are treating the endpoint of the primary censoring window as the origin.</li>
<li>
<span class="math inline">\(S_L = n-w_S\)</span> and <span class="math inline">\(S_R = n\)</span>, that is that we are interested in the probability of the secondary event time falling within the secondary censoring window <span class="math inline">\([n, n+ w_S)\)</span>.</li>
</ul>
<p>Then equation <a href="#eq:park">(4.1)</a> becomes:</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{Pr}(S_L &lt; S &lt; S_R | P_L &lt; P &lt; P_R) &amp;= F(n) - F(n-w_S) - \int_{-w_P}^{0} G_P(x|-w_P, 0) \big[f(n - w_S - x) - f(n - x)\big] dx
\end{aligned}
\]</span>
Making the transformation <span class="math inline">\(x = -p\)</span>, and rewriting in the notation of this note gives:
<span class="math display">\[
\begin{aligned}
&amp;= F(n) - F(n-w_S) + \int_{w_P}^{0} G_P(-p|-w_P, 0) \big[f_T(n - w_S + p) - f_T(n +p)\big] dp \\
&amp;= F(n) - F(n-w_S) + \int_{0}^{w_P} G_P(-p|-w_P, 0) \big[f_T(n + p) - f_T(n - w_S +p)\big] dp\\
&amp;= F(n) - F(n-w_S) + \int_{0}^{w_P} (1 - F_{C_P}(p)) \big[f_T(n + p) - f_T(n - w_S +p)\big] dp\\
&amp;= F(n + w_P) - F(n-w_S + w_P) + \int_{0}^{w_P} [f_T(n + p - w_S) - f_T(n + p)] F_{C_P}(p) dp\\
&amp;= Q_T(n-w_S + w_P) - Q_T(n + w_P) + \int_{0}^{w_P} [f_T(n + p - w_S) - f_T(n + p)] F_{C_P}(p) dp \\
&amp;= Q_{S_+}(n-w_S) - Q_{S_+}(n ).
\end{aligned}
\]</span>
which is same as equation <a href="#eq:seccensorprob">(3.2)</a>.</p>
<p>In this derivation, we have used that <span class="math inline">\(G_P(x|-w_P, 0)\)</span> is the distribution function from the time <em>from</em> the start of the primary interval <em>until</em> primary event time, and <span class="math inline">\(F_{C_P}\)</span> is the distribution function of the time <em>until</em> the end of the primary event window <em>from</em> the primary event time. Therefore, <span class="math inline">\(G_P(-p|-w_P, 0) = Pr(P &lt; -p | P \in (-w_P, 0)) = 1 - Pr(C_P \leq p) = 1 - F_{C_P}(p)\)</span>.</p>
</div>
</div>
<div class="section level2" number="5">
<h2 id="learning-more">
<span class="header-section-number">5</span> Learning more<a class="anchor" aria-label="anchor" href="#learning-more"></a>
</h2>
<ul>
<li>For more mathematical background on the analytic solutions see the <code><a href="../articles/analytic-solutions.html">vignette("analytic-solutions")</a></code>.</li>
<li>For a more introductory explanation of the primary event censored distribution see the <code><a href="../articles/primarycensored.html">vignette("primarycensored")</a></code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" entry-spacing="0" line-spacing="2">
<div id="ref-leung1997censoring" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Leung, K.-M., Elashoff, R. M., &amp; Afifi, A. A. (1997). Censoring issues in survival analysis. <em>Annual Review of Public Health</em>, <em>18</em>(1), 83–104.</div>
</div>
<div id="ref-Park2024" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Park, S. W., Akhmetzhanov, A. R., Charniga, K., Cori, A., Davies, N. G., Dushoff, J., Funk, S., Gostic, K., Grenfell, B., Linton, N. M., Lipsitch, M., Lison, A., Overton, C. E., Ward, T., &amp; Abbott, S. (2024). Estimating epidemiological delay distributions for infectious diseases. <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2024.01.12.24301247" class="external-link">https://doi.org/10.1101/2024.01.12.24301247</a>
</div>
</div>
<div id="ref-Charniga2024" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Charniga, K., Park, S. W., Akhmetzhanov, A. R., Cori, A., Dushoff, J., Funk, S., Gostic, K. M., Linton, N. M., Lison, A., Overton, C. E., Pulliam, J. R. C., Ward, T., Cauchemez, S., &amp; Abbott, S. (2024). Best practices for estimating and reporting epidemiological delay distributions of infectious diseases. <em>PLoS Comput. Biol.</em>, <em>20</em>(10), e1012520. <a href="https://doi.org/10.1371/journal.pcbi.1012520" class="external-link">https://doi.org/10.1371/journal.pcbi.1012520</a>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Sam Brand, James Mba Azam, Carl Pearson, Sebastian Funk, Kelly Charniga.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
