<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analytic solutions for censored delay distributions • primarycensored</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analytic solutions for censored delay distributions">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">primarycensored</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0.1000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/primarycensored.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reference" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reference</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reference">
<li><a class="dropdown-item" href="../reference/index.html">R reference</a></li>
    <li><a class="dropdown-item" href="https://primarycensored.epinowcast.org/stan/">Stan reference</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/using-stan-tools.html">How to use primarycensored with Stan</a></li>
    <li><a class="dropdown-item" href="../articles/fitting-dists-with-stan.html">Fitting distributions using primarycensored and cmdstan</a></li>
    <li><a class="dropdown-item" href="../articles/fitting-dists-with-fitdistrplus.html">Fitting distributions using primarycensored and fitdistrplus</a></li>
    <li><a class="dropdown-item" href="../articles/why-it-works.html">Why it works</a></li>
    <li><a class="dropdown-item" href="../articles/analytic-solutions.html">Analytic solutions for censored delay distributions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epinowcast/primarycensored/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analytic solutions for censored delay distributions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/primarycensored/blob/main/vignettes/analytic-solutions.Rmd" class="external-link"><code>vignettes/analytic-solutions.Rmd</code></a></small>
      <div class="d-none name"><code>analytic-solutions.Rmd</code></div>
    </div>

    
    
<div class="section level2" number="1">
<h2 id="what-are-we-going-to-do-in-this-vignette">
<span class="header-section-number">1</span> What are we going to do in this Vignette<a class="anchor" aria-label="anchor" href="#what-are-we-going-to-do-in-this-vignette"></a>
</h2>
<p>In this vignette, we’ll derive the analytic solutions for the primary censored delay distributions for a range of commonly used distributions.</p>
<ol style="list-style-type: decimal">
<li>Examine the case of exponentially tilted primary event times</li>
<li>Analyse the uniform primary event time case (<span class="math inline">\(r=0\)</span>)</li>
<li>Explore general partial expectation and its role in solving equation <a href="#eq:unifprim">(3.1)</a>
</li>
<li>Provide specific analytic solutions for distributions where the partial expectation can be reduced to an analytic expression</li>
</ol>
</div>
<div class="section level2" number="2">
<h2 id="analytic-solutions-for-exponentially-tilted-primary-event-times">
<span class="header-section-number">2</span> Analytic solutions for exponentially tilted primary event times<a class="anchor" aria-label="anchor" href="#analytic-solutions-for-exponentially-tilted-primary-event-times"></a>
</h2>
<p>In epidemiological analysis, it is common for primary events to be arriving at exponentially increasing or decreasing rates, for example, incidence of new infections in a growing epidemic. In this case, the distribution of the primary event time within its censoring window is biased by the exponential growth or decay. If we assume a reference uniform distribution within a primary censoring window <span class="math inline">\([k, k + w_P)\)</span> then the distribution of the primary event time within the censoring window is the exponential tilted uniform distribution:</p>
<p><span class="math display">\[
f_P(t) \propto \exp(r t) \mathbb{1}_{[k, k + w_P]}(t).
\]</span></p>
<p>In this case, the distribution function for <span class="math inline">\(C_P\)</span>, that is the length of time left in the primary censor window <em>after</em> the primary event time, is given by:</p>
<p><span class="math display" id="eq:fcp">\[
F_{C_P}(p; r) = {  1 - \exp(-r p) \over 1 - \exp(-r w_P)}, \qquad p \in [0, w_P]. \tag{2.1}
\]</span>
Note that taking the limit <span class="math inline">\(\lim_r \rightarrow 0\)</span> in equation <a href="#eq:fcp">(2.1)</a> gives the uniform distribution function <span class="math inline">\(F_{C_P}(p, 0) = p / w_P\)</span>.</p>
<p>In the following, it is convenient to use a (linear) difference operator defined as:</p>
<p><span class="math display">\[
\Delta_{w}f(t) = f(t + w) - f(t).
\]</span></p>
</div>
<div class="section level2" number="3">
<h2 id="uniform-primary-event-time-r0">
<span class="header-section-number">3</span> Uniform primary event time (<span class="math inline">\(r=0\)</span>)<a class="anchor" aria-label="anchor" href="#uniform-primary-event-time-r0"></a>
</h2>
<p>Applying a uniform primary event time distribution to equation 3.1 from <a href="why-it-works.html">“Why it works”</a> gives:</p>
<p><span class="math display">\[
Q_{S_+}(t) = Q_T(t + w_P) + { 1 \over w_P} \int_0^{w_P} f_T(t+p) p~ dp.
\]</span></p>
<p>This is analytically solvable whenever the upper distribution function of <span class="math inline">\(T\)</span> is known and the mean of <span class="math inline">\(T\)</span> is analytically solvable from its integral definition.</p>
<p>In each case considered below it is easier to change the integration variable:</p>
<p><span class="math display" id="eq:unifprim">\[
\begin{aligned}
Q_{S_+}(t) &amp;= Q_T(t + w_P) + { 1 \over w_P} \int_t^{t+w_P} f_T(z) (z-t)~ dz \\
&amp;= Q_T(t + w_P) + { 1 \over w_P} \Big[  \int_t^{t+w_P} f_T(z) z~ dz - t \Delta_{w_P}F_T(t) \Big].
\end{aligned} \tag{3.1}
\]</span></p>
<div class="section level3" number="3.1">
<h3 id="general-partial-expectation">
<span class="header-section-number">3.1</span> General partial expectation<a class="anchor" aria-label="anchor" href="#general-partial-expectation"></a>
</h3>
<p>Note that for any distribution with an analytically available distribution function <span class="math inline">\(F_T\)</span> equation <a href="#eq:unifprim">(3.1)</a> can be solved so long as the <em>partial expectation</em></p>
<p><span class="math display" id="eq:partexp">\[
\int_t^{t+w_P} f_T(z) z~ dz \tag{3.2}
\]</span></p>
<p>can be reduced to an analytic expression.</p>
<p>The insight here is that this will be possible for any distribution where the average of the distribution can be calculated analytically, which includes commonly used non-negative distributions such as the Gamma, Log-Normal and Weibull distributions.</p>
</div>
<div class="section level3" number="3.2">
<h3 id="general-discrete-censored-delay-distribution">
<span class="header-section-number">3.2</span> General Discrete censored delay distribution<a class="anchor" aria-label="anchor" href="#general-discrete-censored-delay-distribution"></a>
</h3>
<p>First, we note that equation 3.3 from <a href="why-it-works.html">“Why it works”</a> can be written using the difference operator: <span class="math inline">\(f_n = -\Delta_1 Q_{S_+}(n-1)\)</span>. We can insert this expression into equation <a href="#eq:unifprim">(3.1)</a> to give the discrete censored delay distribution for uniformly distributed primary event times:</p>
<p><span class="math display" id="eq:disccensunifprim">\[
\begin{aligned}
f_n &amp;= \Delta_1\Big[(n-1) \Delta_1F_T(n-1)\Big] - \Delta_1Q_T(n) - \Delta_1\Big[ \int_{n-1}^n f_T(z) z ~dz \Big] \\
&amp;= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) - \Delta_1\Big[ \int_{n-1}^n f_T(z) z ~dz \Big].
\end{aligned}  \tag{3.3}
\]</span></p>
<p>We now consider some specific delay distributions.</p>
</div>
<div class="section level3" number="3.3">
<h3 id="gamma-distributed-delay-times">
<span class="header-section-number">3.3</span> Gamma distributed delay times<a class="anchor" aria-label="anchor" href="#gamma-distributed-delay-times"></a>
</h3>
<p>The Gamma distribution has the density function:</p>
<p><span class="math display">\[
f_T(z;k, \theta) = {1 \over \Gamma(k) \theta^k} z^{k-1} \exp(-z/\theta).
\]</span>
Where <span class="math inline">\(\Gamma\)</span> is the Gamma function.</p>
<p>The Gamma distribution has the distribution function:</p>
<p><span class="math display">\[
\begin{aligned}
F_T(z;k, \theta) &amp;= {\gamma(k, z/\theta) \over \Gamma(k)}, \qquad z\geq 0,\\
F_T(z;k, \theta) &amp;= 0, \qquad z &lt; 0.
\end{aligned}
\]</span>
Where <span class="math inline">\(\gamma\)</span> is the lower incomplete gamma function.</p>
<div class="section level4" number="3.3.1">
<h4 id="gamma-partial-expectation">
<span class="header-section-number">3.3.1</span> Gamma partial expectation<a class="anchor" aria-label="anchor" href="#gamma-partial-expectation"></a>
</h4>
<p>We know that the full expectation of the Gamma distribution is <span class="math inline">\(\mathbb{E}[T] = k\theta\)</span>, which can be calculated as a standard integral. Doing the same integral for the partial expectation gives:</p>
<p><span class="math display" id="eq:gammapartexp">\[
\begin{aligned}
\int_t^{t+w_P} f_T(z) z~ dz &amp;= {1 \over \Gamma(k) \theta^k} \int_t^{t+w_P} \mathbb{1}(z \geq 0)  z  z^{k-1} \exp(-z/\theta)~dz \\
&amp;=  {\Gamma(k+1) \theta^{k+1} \over \Gamma(k) \theta^k}  {1 \over \Gamma(k+1) \theta^{k+1}} \int_t^{t+w_P} \mathbb{1}(z \geq 0)  z^{k}  \exp(-z/\theta)~dz\\
&amp;= k\theta \Delta_{w_P} F_T(t; k + 1, \theta).
\end{aligned} \tag{3.4}
\]</span></p>
</div>
<div class="section level4" number="3.3.2">
<h4 id="survival-function-of-s_-for-gamma-distribution">
<span class="header-section-number">3.3.2</span> Survival function of <span class="math inline">\(S_{+}\)</span> for Gamma distribution<a class="anchor" aria-label="anchor" href="#survival-function-of-s_-for-gamma-distribution"></a>
</h4>
<p>By substituting equation <a href="#eq:gammapartexp">(3.4)</a> into equation <a href="#eq:disccensunifprim">(3.3)</a> we can solve for the survival function of <span class="math inline">\(S_+\)</span> in terms of analytically available functions:</p>
<p><span class="math display" id="eq:survgammaunifprim">\[
Q_{S_+}(t; k, \theta) = Q_T(t + w_P; k, \theta) + { 1 \over w_P} \big[ k \theta \Delta_{w_P}F_T(t; k+1, \theta) - t \Delta_{w_P}F_T(t; k, \theta) \big].
\tag{3.5}
\]</span></p>
</div>
<div class="section level4" number="3.3.3">
<h4 id="gamma-discrete-censored-delay-distribution">
<span class="header-section-number">3.3.3</span> Gamma discrete censored delay distribution<a class="anchor" aria-label="anchor" href="#gamma-discrete-censored-delay-distribution"></a>
</h4>
<p>By substituting <a href="#eq:survgammaunifprim">(3.5)</a> into <a href="#eq:disccensunifprim">(3.3)</a> we get the discrete censored delay distribution in terms of analytically available functions:
<span class="math display">\[
\begin{aligned}
f_n &amp;= (n+1) F_T(n+1; k, \theta) + (n-1) F_T(n-1; k, \theta) - 2  n F_T(n; k, \theta) - k \theta \Delta_1^{(2)}F_T(n-1; k+1, \theta)\\
&amp;= (n+1) F_T(n+1; k, \theta) + (n-1) F_T(n-1; k, \theta) - 2  n F_T(n; k, \theta) \\
&amp;+ k \theta \Big( 2 F_T(n; k+1, \theta) - F_T(n-1; k+1, \theta) - F_T(n+1; k+1,\theta)  \Big) \qquad n = 0, 1, \dots.
\end{aligned}
\]</span></p>
<p>Which was also found by Cori <em>et al</em><span class="citation"><sup>[<a href="#ref-cori2013new">1</a>]</sup></span>.</p>
</div>
</div>
<div class="section level3" number="3.4">
<h3 id="log-normal-distribution">
<span class="header-section-number">3.4</span> Log-Normal distribution<a class="anchor" aria-label="anchor" href="#log-normal-distribution"></a>
</h3>
<p>The Log-Normal distribution has the density function:</p>
<p><span class="math display">\[
\begin{aligned}
f_T(z;\mu, \sigma) &amp;= {1 \over z \sigma \sqrt{2\pi}} \exp\left( - {(\log(z) - \mu)^2 \over 2 \sigma^2} \right)\\
F_T(z;\mu, \sigma) &amp;= 0, \qquad z &lt; 0.
\end{aligned}
\]</span>
And distribution function:</p>
<p><span class="math display">\[
F_T(z;\mu, \sigma) = \Phi\left( {\log(z) - \mu \over \sigma} \right).
\]</span>
Where <span class="math inline">\(\Phi\)</span> is the standard normal distribution function.</p>
<div class="section level4" number="3.4.1">
<h4 id="log-normal-partial-expectation">
<span class="header-section-number">3.4.1</span> Log-Normal partial expectation<a class="anchor" aria-label="anchor" href="#log-normal-partial-expectation"></a>
</h4>
<p>We know that the full expectation of the Log-Normal distribution is <span class="math inline">\(\mathbb{E}[T] = e^{\mu + \frac{1}{2} \sigma^2}\)</span>, which can be calculated by integration with the integration substitution <span class="math inline">\(y = (\ln z - \mu) / \sigma\)</span>. This has transformation Jacobian:</p>
<p><span class="math display">\[
\frac{dz}{dy} = \sigma e^{\sigma y + \mu}.
\]</span></p>
<p>Doing the same integral for the partial expectation, and using the same integration substitution gives:</p>
<p><span class="math display" id="eq:lognormpartexp">\[
\begin{aligned}
\int_t^{t+w_P} z~ f_T(z; \mu, \sigma) dz &amp;= {1 \over \sigma \sqrt{2\pi}} \int_t^{t+w_P}  \mathbb{1}(z \geq 0)  \exp\left( - {(\log(z) - \mu)^2 \over 2 \sigma^2} \right) dz \\
&amp;= {1 \over \sqrt{2\pi}} \int_{(\ln t - \mu)/\sigma}^{(\ln(t+w_P) - \mu)/\sigma} e^{\sigma y + \mu} e^{-y^2/2} dy\\
&amp;= {e^{\mu + \frac{1}{2} \sigma^2} \over \sqrt{2 \pi} } \int_{(\ln t - \mu)/\sigma}^{(\ln(t+w_P) - \mu)/\sigma} e^{-(y- \sigma)^2/2} dy \\
&amp;= e^{\mu + \frac{1}{2} \sigma^2} \Big[\Phi\Big({\ln(t+w_P) - \mu \over \sigma} - \sigma\Big) - \Phi\Big({\ln(t) - \mu \over \sigma} - \sigma\Big) \Big]\\
&amp;= e^{\mu + \frac{1}{2} \sigma^2} \Delta_{w_P}F_T(t; \mu + \sigma^2, \sigma).
\end{aligned} \tag{3.6}
\]</span></p>
</div>
<div class="section level4" number="3.4.2">
<h4 id="survival-function-of-s_-for-log-normal-distribution">
<span class="header-section-number">3.4.2</span> Survival function of <span class="math inline">\(S_{+}\)</span> for Log-Normal distribution<a class="anchor" aria-label="anchor" href="#survival-function-of-s_-for-log-normal-distribution"></a>
</h4>
<p>By substituting equation <a href="#eq:lognormpartexp">(3.6)</a> into equation <a href="#eq:disccensunifprim">(3.3)</a> we can solve for the survival function of <span class="math inline">\(S_+\)</span> in terms of analytically available functions:</p>
<p><span class="math display">\[
Q_{S+}(t ;\mu, \sigma) = Q_T(t + w_P;\mu, \sigma) + { 1 \over w_P} \Big[ e^{\mu + \frac{1}{2} \sigma^2} \Delta_{w_P}F_T(t; \mu + \sigma^2, \sigma) - t\Delta_{w_P}F_T(t; \mu, \sigma) \Big]
\]</span></p>
</div>
<div class="section level4" number="3.4.3">
<h4 id="log-normal-discrete-censored-delay-distribution">
<span class="header-section-number">3.4.3</span> Log-Normal discrete censored delay distribution<a class="anchor" aria-label="anchor" href="#log-normal-discrete-censored-delay-distribution"></a>
</h4>
<p>By substituting <a href="#eq:lognormpartexp">(3.6)</a> into <a href="#eq:disccensunifprim">(3.3)</a> we get the discrete censored delay distribution in terms of analytically available functions:</p>
<p><span class="math display">\[
\begin{aligned}
f_n &amp;= (n+1) F_T(n+1; \mu, \sigma) + (n-1) F_T(n-1; \mu, \sigma) - 2 n F_T(n; \mu, \sigma) \\
&amp;- e^{\mu + \frac{1}{2} \sigma^2} \Delta_1^{(2)}F_T(n-1;\mu + \sigma^2, \sigma) \\
&amp;= (n+1) F_T(n+1; \mu, \sigma) + (n-1) F_T(n-1; \mu, \sigma) - 2 n F_T(n; \mu, \sigma) \\
  &amp;+ e^{\mu + \frac{1}{2} \sigma^2} \Big( 2 F_T(n; \mu + \sigma^2, \sigma) - F_T(n+1; \mu + \sigma^2, \sigma) - F_T(n-1; \mu + \sigma^2, \sigma)  \Big)\qquad n = 0, 1, \dots.
\end{aligned}
\]</span></p>
</div>
</div>
<div class="section level3" number="3.5">
<h3 id="weibull-distribution">
<span class="header-section-number">3.5</span> Weibull distribution<a class="anchor" aria-label="anchor" href="#weibull-distribution"></a>
</h3>
<p>The Weibull distribution has the density function:</p>
<p><span class="math display">\[
f_T(z;\lambda,k) =
\begin{cases}
\frac{k}{\lambda}\left(\frac{z}{\lambda}\right)^{k-1}e^{-(z/\lambda)^{k}}, &amp; z\geq0 ,\\
0, &amp; z&lt;0,
\end{cases}
\]</span>
And distribution function:</p>
<p><span class="math display">\[
F_T(z;\lambda,k))=\begin{cases}1 - e^{-(z/\lambda)^k}, &amp; z\geq0,\\ 0, &amp; z&lt;0.\end{cases}
\]</span>
Where <span class="math inline">\(\Phi\)</span> is the standard normal distribution function.</p>
<div class="section level4" number="3.5.1">
<h4 id="weibull-partial-expectation">
<span class="header-section-number">3.5.1</span> Weibull partial expectation<a class="anchor" aria-label="anchor" href="#weibull-partial-expectation"></a>
</h4>
<p>We know that the full expectation of the Weibull distribution is <span class="math inline">\(\mathbb{E}[T] = \lambda \Gamma(1 + 1/k)\)</span>, which can be calculated by integration using the integration substitution <span class="math inline">\(y = (z / \lambda)^k\)</span>, which has transformation Jacobian:</p>
<p><span class="math display">\[
\frac{dz}{dy} = \frac{\lambda}{k}y^{1/k - 1}.
\]</span></p>
<p>Doing the same integral for the partial expectation, and using the same integration substitution gives:</p>
<p><span class="math display" id="eq:weibullpartexp">\[
\begin{aligned}
\int_{t}^{t+w_P} z~ f_T(z; \lambda,k) dz  &amp;= \int_t^{t+w_P} \mathbb{1}(z \geq 0) \frac{kz}{\lambda}\left(\frac{z}{\lambda}\right)^{k-1}e^{-(z/\lambda)^{k}} dz \\
&amp;= k\int_t^{t+w_P} \mathbb{1}(z \geq 0) \left(\frac{z}{\lambda}\right)^{k}e^{-(z/\lambda)^{k}} dz  \\
&amp;= \lambda k \int_{(t / \lambda)^k}^{((t + w_P) / \lambda)^k} \mathbb{1}(y \geq 0) y y^{1/k - 1} e^{-y} dy  \\
&amp;= \lambda\int_{(t / \lambda)^k}^{((t + w_P) / \lambda)^k} \mathbb{1}(y \geq 0)  y^{1/k} e^{-y} dy\\
&amp;= \lambda \Delta_{w_P} g(t; \lambda,k)
\end{aligned} \tag{3.7}
\]</span></p>
<p>Where</p>
<p><span class="math display">\[
g(t; \lambda, k) =  \gamma\left(1 + 1/k, \left({t\vee 0 \over \lambda}\right)^k\right) =  \frac{1}{k}\gamma\left(1/k, \left({t\vee 0 \over \lambda}\right)^k\right) - \frac{t}{\lambda}\exp\left(-\left({t\vee 0 \over \lambda}\right)^k\right)
\]</span>
is a reparametrisation of the lower incomplete gamma function. Note that the <span class="math inline">\(\vee\)</span> operator <span class="math inline">\(t \vee 0 = \text{max}(0, t)\)</span> comes into the expression due to <span class="math inline">\(\mathbb{1}(y \geq 0)\)</span> term in the integrand.</p>
</div>
</div>
<div class="section level3" number="3.6">
<h3 id="survival-function-of-s_-for-weibull-distribution">
<span class="header-section-number">3.6</span> Survival function of <span class="math inline">\(S_{+}\)</span> for Weibull distribution<a class="anchor" aria-label="anchor" href="#survival-function-of-s_-for-weibull-distribution"></a>
</h3>
<p>By substituting equation <a href="#eq:weibullpartexp">(3.7)</a> into equation <a href="#eq:disccensunifprim">(3.3)</a> we can solve for the survival function of <span class="math inline">\(S_+\)</span> in terms of analytically available functions:</p>
<p><span class="math display">\[
Q_{S+}(t ;\lambda,k) = Q_T(t + w_P; \lambda,k) + { 1 \over w_P} \Big[ \lambda \Delta_{w_P} g(t; \lambda,k) - t\Delta_{w_P}F_T(t; \lambda,k)\Big].
\]</span></p>
<div class="section level4" number="3.6.1">
<h4 id="weibull-discrete-censored-delay-distribution">
<span class="header-section-number">3.6.1</span> Weibull discrete censored delay distribution<a class="anchor" aria-label="anchor" href="#weibull-discrete-censored-delay-distribution"></a>
</h4>
<p>By substituting <a href="#eq:weibullpartexp">(3.7)</a> into <a href="#eq:disccensunifprim">(3.3)</a> we get the discrete censored delay distribution in terms of analytically available functions:</p>
<p><span class="math display">\[
\begin{aligned}
f_n &amp;= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) - \Delta_1\Big[ \int_{n-1}^n f_T(z) z ~dz \Big] \\
&amp;= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) - \lambda \Delta_1^{(2)} g(n-1; \lambda,k) \\
&amp;= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) \\
&amp;+ \lambda [2 g(n; \lambda,k) - g(n+1; \lambda,k) - g(n-1; \lambda,k)] \qquad n = 0, 1, \dots.
\end{aligned}
\]</span></p>
<p>Which was also found by Cori <em>et al</em><span class="citation"><sup>[<a href="#ref-cori2013new">1</a>]</sup></span>.</p>
</div>
</div>
</div>
<div class="section level2" number="4">
<h2 id="learning-more">
<span class="header-section-number">4</span> Learning more<a class="anchor" aria-label="anchor" href="#learning-more"></a>
</h2>
<ul>
<li>For more mathematical background on the analytic solutions see the <code><a href="../articles/why-it-works.html">vignette("why-it-works")</a></code>.</li>
<li>For a more introductory explanation of the primary event censored distribution see the <code><a href="../articles/primarycensored.html">vignette("primarycensored")</a></code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-cori2013new" class="csl-entry">
1. Cori, A., Ferguson, N. M., Fraser, C., &amp; Cauchemez, S. (2013). A new framework and software to estimate time-varying reproduction numbers during epidemics. <em>American Journal of Epidemiology</em>, <em>178</em>(9), 1505–1512.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Sam Brand, Carl Pearson, Sebastian Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
