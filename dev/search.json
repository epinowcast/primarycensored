[{"path":"https://primarycensored.epinowcast.org/dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 primarycensored authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"what-are-we-going-to-do-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"What are we going to do in this vignette","title":"Analytic solutions for censored delay distributions","text":"vignette, ’ll derive analytic solutions primary censored delay distributions range commonly used distributions. Examine case exponentially tilted primary event times Analyse uniform primary event time case (\\(r=0\\)) Explore general partial expectation role solving equation (3.1) Provide specific analytic solutions distributions partial expectation can reduced analytic expression","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"analytic-solutions-for-exponentially-tilted-primary-event-times","dir":"Articles","previous_headings":"","what":"Analytic solutions for exponentially tilted primary event times","title":"Analytic solutions for censored delay distributions","text":"epidemiological analysis, common primary events occur exponentially increasing decreasing rates, example, incidence new infections epidemic. case, distribution primary event time within censoring window biased exponential growth decay[1] (.e. exponential growth, event time likely closer end censoring window vice versa decay). assume reference uniform distribution within primary censoring window \\([k, k + w_P)\\) distribution primary event time within censoring window exponential tilted uniform distribution: \\[ f_P(t) \\propto \\exp(r t) \\mathbb{1}_{[k, k + w_P]}(t). \\] case, distribution function \\(C_P\\), length time left primary censor window primary event time, given : \\[ F_{C_P}(p; r) = {  1 - \\exp(-r p) \\1 - \\exp(-r w_P)}, \\qquad p \\[0, w_P]. \\tag{2.1} \\] Note taking limit \\(\\lim_r \\rightarrow 0\\) equation (2.1) gives uniform distribution function \\(F_{C_P}(p, 0) = p / w_P\\). following, convenient use (linear) difference operator defined : \\[ \\Delta_{w}f(t) = f(t + w) - f(t). \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"uniform-primary-event-time-r0","dir":"Articles","previous_headings":"","what":"Uniform primary event time (\\(r=0\\))","title":"Analytic solutions for censored delay distributions","text":"Applying uniform primary event time distribution equation 3.1 “works” gives: \\[ Q_{S_+}(t) = Q_T(t + w_P) + { 1 \\w_P} \\int_0^{w_P} f_T(t+p) p~ dp. \\] analytically solvable whenever upper distribution function \\(T\\) known mean \\(T\\) analytically solvable integral definition. case considered easier change integration variable: \\[ \\begin{aligned} Q_{S_+}(t) &= Q_T(t + w_P) + { 1 \\w_P} \\int_t^{t+w_P} f_T(z) (z-t)~ dz \\\\ &= Q_T(t + w_P) + { 1 \\w_P} \\Big[  \\int_t^{t+w_P} f_T(z) z~ dz - t \\Delta_{w_P}F_T(t) \\Big]. \\end{aligned} \\tag{3.1} \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"general-partial-expectation","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\))","what":"General partial expectation","title":"Analytic solutions for censored delay distributions","text":"Note distribution analytically available distribution function \\(F_T\\) equation (3.1) can solved long partial expectation \\[ \\int_t^{t+w_P} f_T(z) z~ dz \\tag{3.2} \\] can reduced analytic expression. insight possible distribution average distribution can calculated analytically, includes commonly used non-negative distributions Gamma, Log-Normal Weibull distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"general-discrete-censored-delay-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\))","what":"General Discrete censored delay distribution","title":"Analytic solutions for censored delay distributions","text":"First, note equation 3.3 “works” can written using difference operator: \\(f_n = -\\Delta_1 Q_{S_+}(n-1)\\). can insert expression equation (3.1) give discrete censored delay distribution uniformly distributed primary event times: \\[ \\begin{aligned} f_n &= \\Delta_1\\Big[(n-1) \\Delta_1F_T(n-1)\\Big] - \\Delta_1Q_T(n) - \\Delta_1\\Big[ \\int_{n-1}^n f_T(z) z ~dz \\Big] \\\\ &= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) - \\Delta_1\\Big[ \\int_{n-1}^n f_T(z) z ~dz \\Big]. \\end{aligned}  \\tag{3.3} \\] now consider specific delay distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"gamma-distributed-delay-times","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\))","what":"Gamma distributed delay times","title":"Analytic solutions for censored delay distributions","text":"Gamma distribution density function: \\[ f_T(z;k, \\theta) = {1 \\\\Gamma(k) \\theta^k} z^{k-1} \\exp(-z/\\theta). \\] \\(\\Gamma\\) Gamma function. Gamma distribution distribution function: \\[ \\begin{aligned} F_T(z;k, \\theta) &= {\\gamma(k, z/\\theta) \\\\Gamma(k)}, \\qquad z\\geq 0,\\\\ F_T(z;k, \\theta) &= 0, \\qquad z < 0. \\end{aligned} \\] \\(\\gamma\\) lower incomplete gamma function.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"gamma-partial-expectation","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.3 Gamma distributed delay times","what":"Gamma partial expectation","title":"Analytic solutions for censored delay distributions","text":"know full expectation Gamma distribution \\(\\mathbb{E}[T] = k\\theta\\), can calculated standard integral. integral partial expectation gives: \\[ \\begin{aligned} \\int_t^{t+w_P} f_T(z) z~ dz &= {1 \\\\Gamma(k) \\theta^k} \\int_t^{t+w_P} \\mathbb{1}(z \\geq 0)  z  z^{k-1} \\exp(-z/\\theta)~dz \\\\ &=  {\\Gamma(k+1) \\theta^{k+1} \\\\Gamma(k) \\theta^k}  {1 \\\\Gamma(k+1) \\theta^{k+1}} \\int_t^{t+w_P} \\mathbb{1}(z \\geq 0)  z^{k}  \\exp(-z/\\theta)~dz\\\\ &= k\\theta \\Delta_{w_P} F_T(t; k + 1, \\theta). \\end{aligned} \\tag{3.4} \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"survival-function-of-s_-for-gamma-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.3 Gamma distributed delay times","what":"Survival function of \\(S_{+}\\) for Gamma distribution","title":"Analytic solutions for censored delay distributions","text":"substituting equation (3.4) equation (3.3) can solve survival function \\(S_+\\) terms analytically available functions: \\[ Q_{S_+}(t; k, \\theta) = Q_T(t + w_P; k, \\theta) + { 1 \\w_P} \\big[ k \\theta \\Delta_{w_P}F_T(t; k+1, \\theta) - t \\Delta_{w_P}F_T(t; k, \\theta) \\big]. \\tag{3.5} \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"gamma-discrete-censored-delay-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.3 Gamma distributed delay times","what":"Gamma discrete censored delay distribution","title":"Analytic solutions for censored delay distributions","text":"substituting (3.5) (3.3) get discrete censored delay distribution terms analytically available functions: \\[ \\begin{aligned} f_n &= (n+1) F_T(n+1; k, \\theta) + (n-1) F_T(n-1; k, \\theta) - 2  n F_T(n; k, \\theta) - k \\theta \\Delta_1^{(2)}F_T(n-1; k+1, \\theta)\\\\ &= (n+1) F_T(n+1; k, \\theta) + (n-1) F_T(n-1; k, \\theta) - 2  n F_T(n; k, \\theta) \\\\ &+ k \\theta \\Big( 2 F_T(n; k+1, \\theta) - F_T(n-1; k+1, \\theta) - F_T(n+1; k+1,\\theta)  \\Big) \\qquad n = 0, 1, \\dots. \\end{aligned} \\] also found Cori et al[2].","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"log-normal-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\))","what":"Log-Normal distribution","title":"Analytic solutions for censored delay distributions","text":"Log-Normal distribution density function: \\[ \\begin{aligned} f_T(z;\\mu, \\sigma) &= {1 \\z \\sigma \\sqrt{2\\pi}} \\exp\\left( - {(\\log(z) - \\mu)^2 \\2 \\sigma^2} \\right)\\\\ F_T(z;\\mu, \\sigma) &= 0, \\qquad z < 0. \\end{aligned} \\] distribution function: \\[ F_T(z;\\mu, \\sigma) = \\Phi\\left( {\\log(z) - \\mu \\\\sigma} \\right). \\] \\(\\Phi\\) standard normal distribution function.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"log-normal-partial-expectation","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.4 Log-Normal distribution","what":"Log-Normal partial expectation","title":"Analytic solutions for censored delay distributions","text":"know full expectation Log-Normal distribution \\(\\mathbb{E}[T] = e^{\\mu + \\frac{1}{2} \\sigma^2}\\), can calculated integration integration substitution \\(y = (\\ln z - \\mu) / \\sigma\\). transformation Jacobian: \\[ \\frac{dz}{dy} = \\sigma e^{\\sigma y + \\mu}. \\] integral partial expectation, using integration substitution gives: \\[ \\begin{aligned} \\int_t^{t+w_P} z~ f_T(z; \\mu, \\sigma) dz &= {1 \\\\sigma \\sqrt{2\\pi}} \\int_t^{t+w_P}  \\mathbb{1}(z \\geq 0)  \\exp\\left( - {(\\log(z) - \\mu)^2 \\2 \\sigma^2} \\right) dz \\\\ &= {1 \\\\sqrt{2\\pi}} \\int_{(\\ln t - \\mu)/\\sigma}^{(\\ln(t+w_P) - \\mu)/\\sigma} e^{\\sigma y + \\mu} e^{-y^2/2} dy\\\\ &= {e^{\\mu + \\frac{1}{2} \\sigma^2} \\\\sqrt{2 \\pi} } \\int_{(\\ln t - \\mu)/\\sigma}^{(\\ln(t+w_P) - \\mu)/\\sigma} e^{-(y- \\sigma)^2/2} dy \\\\ &= e^{\\mu + \\frac{1}{2} \\sigma^2} \\Big[\\Phi\\Big({\\ln(t+w_P) - \\mu \\\\sigma} - \\sigma\\Big) - \\Phi\\Big({\\ln(t) - \\mu \\\\sigma} - \\sigma\\Big) \\Big]\\\\ &= e^{\\mu + \\frac{1}{2} \\sigma^2} \\Delta_{w_P}F_T(t; \\mu + \\sigma^2, \\sigma). \\end{aligned} \\tag{3.6} \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"survival-function-of-s_-for-log-normal-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.4 Log-Normal distribution","what":"Survival function of \\(S_{+}\\) for Log-Normal distribution","title":"Analytic solutions for censored delay distributions","text":"substituting equation (3.6) equation (3.3) can solve survival function \\(S_+\\) terms analytically available functions: \\[ Q_{S+}(t ;\\mu, \\sigma) = Q_T(t + w_P;\\mu, \\sigma) + { 1 \\w_P} \\Big[ e^{\\mu + \\frac{1}{2} \\sigma^2} \\Delta_{w_P}F_T(t; \\mu + \\sigma^2, \\sigma) - t\\Delta_{w_P}F_T(t; \\mu, \\sigma) \\Big] \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"log-normal-discrete-censored-delay-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.4 Log-Normal distribution","what":"Log-Normal discrete censored delay distribution","title":"Analytic solutions for censored delay distributions","text":"substituting (3.6) (3.3) get discrete censored delay distribution terms analytically available functions: \\[ \\begin{aligned} f_n &= (n+1) F_T(n+1; \\mu, \\sigma) + (n-1) F_T(n-1; \\mu, \\sigma) - 2 n F_T(n; \\mu, \\sigma) \\\\ &- e^{\\mu + \\frac{1}{2} \\sigma^2} \\Delta_1^{(2)}F_T(n-1;\\mu + \\sigma^2, \\sigma) \\\\ &= (n+1) F_T(n+1; \\mu, \\sigma) + (n-1) F_T(n-1; \\mu, \\sigma) - 2 n F_T(n; \\mu, \\sigma) \\\\   &+ e^{\\mu + \\frac{1}{2} \\sigma^2} \\Big( 2 F_T(n; \\mu + \\sigma^2, \\sigma) - F_T(n+1; \\mu + \\sigma^2, \\sigma) - F_T(n-1; \\mu + \\sigma^2, \\sigma)  \\Big)\\qquad n = 0, 1, \\dots. \\end{aligned} \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"weibull-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\))","what":"Weibull distribution","title":"Analytic solutions for censored delay distributions","text":"Weibull distribution density function: \\[ f_T(z;\\lambda,k) = \\begin{cases} \\frac{k}{\\lambda}\\left(\\frac{z}{\\lambda}\\right)^{k-1}e^{-(z/\\lambda)^{k}}, & z\\geq0 ,\\\\ 0, & z<0, \\end{cases} \\] distribution function: \\[ F_T(z;\\lambda,k))=\\begin{cases}1 - e^{-(z/\\lambda)^k}, & z\\geq0,\\\\ 0, & z<0.\\end{cases} \\] \\(\\Phi\\) standard normal distribution function.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"weibull-partial-expectation","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.5 Weibull distribution","what":"Weibull partial expectation","title":"Analytic solutions for censored delay distributions","text":"know full expectation Weibull distribution \\(\\mathbb{E}[T] = \\lambda \\Gamma(1 + 1/k)\\), can calculated integration using integration substitution \\(y = (z / \\lambda)^k\\), transformation Jacobian: \\[ \\frac{dz}{dy} = \\frac{\\lambda}{k}y^{1/k - 1}. \\] integral partial expectation, using integration substitution gives: \\[ \\begin{aligned} \\int_{t}^{t+w_P} z~ f_T(z; \\lambda,k) dz  &= \\int_t^{t+w_P} \\mathbb{1}(z \\geq 0) \\frac{kz}{\\lambda}\\left(\\frac{z}{\\lambda}\\right)^{k-1}e^{-(z/\\lambda)^{k}} dz \\\\ &= k\\int_t^{t+w_P} \\mathbb{1}(z \\geq 0) \\left(\\frac{z}{\\lambda}\\right)^{k}e^{-(z/\\lambda)^{k}} dz  \\\\ &= \\lambda k \\int_{(t / \\lambda)^k}^{((t + w_P) / \\lambda)^k} \\mathbb{1}(y \\geq 0) y y^{1/k - 1} e^{-y} dy  \\\\ &= \\lambda\\int_{(t / \\lambda)^k}^{((t + w_P) / \\lambda)^k} \\mathbb{1}(y \\geq 0)  y^{1/k} e^{-y} dy\\\\ &= \\lambda \\Delta_{w_P} g(t; \\lambda,k) \\end{aligned} \\tag{3.7} \\] \\[ g(t; \\lambda, k) =  \\gamma\\left(1 + 1/k, \\left({t\\vee 0 \\\\lambda}\\right)^k\\right) =  \\frac{1}{k}\\gamma\\left(1/k, \\left({t\\vee 0 \\\\lambda}\\right)^k\\right) - \\frac{t}{\\lambda}\\exp\\left(-\\left({t\\vee 0 \\\\lambda}\\right)^k\\right) \\] reparametrisation lower incomplete gamma function. Note \\(\\vee\\) operator \\(t \\vee 0 = \\text{max}(0, t)\\) comes expression due \\(\\mathbb{1}(y \\geq 0)\\) term integrand.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"survival-function-of-s_-for-weibull-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\))","what":"Survival function of \\(S_{+}\\) for Weibull distribution","title":"Analytic solutions for censored delay distributions","text":"substituting equation (3.7) equation (3.3) can solve survival function \\(S_+\\) terms analytically available functions: \\[ Q_{S+}(t ;\\lambda,k) = Q_T(t + w_P; \\lambda,k) + { 1 \\w_P} \\Big[ \\lambda \\Delta_{w_P} g(t; \\lambda,k) - t\\Delta_{w_P}F_T(t; \\lambda,k)\\Big]. \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"weibull-discrete-censored-delay-distribution","dir":"Articles","previous_headings":"3 Uniform primary event time (\\(r=0\\)) > 3.6 Survival function of \\(S_{+}\\) for Weibull distribution","what":"Weibull discrete censored delay distribution","title":"Analytic solutions for censored delay distributions","text":"substituting (3.7) (3.3) get discrete censored delay distribution terms analytically available functions: \\[ \\begin{aligned} f_n &= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) - \\Delta_1\\Big[ \\int_{n-1}^n f_T(z) z ~dz \\Big] \\\\ &= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) - \\lambda \\Delta_1^{(2)} g(n-1; \\lambda,k) \\\\ &= (n+1)F_T(n+1)  + (n-1)F_T(n-1) - 2nF_T(n) \\\\ &+ \\lambda [2 g(n; \\lambda,k) - g(n+1; \\lambda,k) - g(n-1; \\lambda,k)] \\qquad n = 0, 1, \\dots. \\end{aligned} \\] also found Cori et al[2].","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/analytic-solutions.html","id":"learning-more","dir":"Articles","previous_headings":"","what":"Learning more","title":"Analytic solutions for censored delay distributions","text":"mathematical background analytic solutions see vignette(\"--works\"). introductory explanation primary event censored distribution see vignette(\"primarycensored\").","code":""},{"path":[]},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"what-are-we-going-to-do-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"What are we going to do in this vignette","title":"Fitting distributions using primarycensored and fitdistrplus","text":"vignette, ’ll demonstrate use primarycensored conjunction fitdistrplus fitting distributions. ’ll cover following key points: Simulating censored delay distribution data Fitting naive model using fitdistrplus Evaluating naive model’s performance Fitting improved model using primarycensored functionality Comparing primarycensored model’s performance naive model","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"what-you-will-learn","dir":"Articles","previous_headings":"1 Introduction","what":"What you will learn","title":"Fitting distributions using primarycensored and fitdistrplus","text":"end vignette, able : - Understand bias introduced ignoring primary censoring truncation fitting delay distributions - Use fitdistdoublecens() fit distributions properly account primary censoring, secondary censoring, truncation - Understand MLE-based fitting fitdistrplus appropriate versus Bayesian approaches Stan","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"what-might-i-need-to-know-before-starting","dir":"Articles","previous_headings":"1 Introduction","what":"What might I need to know before starting","title":"Fitting distributions using primarycensored and fitdistrplus","text":"vignette assumes familiarity fitdistrplus package. familiar might want start Introduction fitdistrplus vignette.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"how-does-this-vignette-differ-from-fitting-distributions-with-stan-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"How does this vignette differ from fitting distributions with Stan vignette","title":"Fitting distributions using primarycensored and fitdistrplus","text":"vignette similar vignette(\"fitting-dists--stan\") vignette shows fit distribution using primarycensored. However, use maximum likelihood estimation (MLE) fit distribution, rather MCMC. settings may result faster fit, settings especially data complex, MCMC may reliable. major benefit fitdistrplus approach don’t need install additional software (Stan) fit distribution. Note rather returning credible intervals, fitdistrplus package returns standard errors confidence intervals.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"packages-used-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"Packages used in this vignette","title":"Fitting distributions using primarycensored and fitdistrplus","text":"Alongside primarycensored package use fitdistrplus package fitting distributions. also use ggplot2 package plotting dplyr data manipulation.","code":"library(primarycensored) library(fitdistrplus) library(ggplot2) library(dplyr)"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"simulating-censored-and-truncated-delay-distribution-data","dir":"Articles","previous_headings":"","what":"Simulating censored and truncated delay distribution data","title":"Fitting distributions using primarycensored and fitdistrplus","text":"’ll start simulating censored truncated delay distribution data. ’ll use rprimarycensored function (actually use rpcens alias brevity).  figure can see impact truncation censoring observed distribution much lower mean (vertical dashed blue line) true/theoretical distribution (vertical dashed black line). modelling aim recover true parameters theoretical distribution observed distribution (.e. recover black lines blue lines).","code":"set.seed(123) # For reproducibility  # Define the number of samples to generate n <- 1000  # Define the true distribution parameters shape <- 1.77 # This gives a mean of 4 and sd of 3 for a gamma distribution rate <- 0.44  # Generate fixed pwindow, swindow, and obs_time pwindows <- rep(1, n) swindows <- rep(1, n) obs_times <- sample(8:10, n, replace = TRUE)  # Function to generate a single sample generate_sample <- function(pwindow, swindow, obs_time) {   rpcens(     1, rgamma,     shape = shape, rate = rate,     pwindow = pwindow, swindow = swindow, D = obs_time   ) }  # Generate samples samples <- mapply(generate_sample, pwindows, swindows, obs_times)  # Create initial data frame delay_data <- data.frame(   delay = samples,   delay_upper = samples + swindows,   pwindow = pwindows,   relative_obs_time = obs_times )  head(delay_data) ##   delay delay_upper pwindow relative_obs_time ## 1     2           3       1                10 ## 2     1           2       1                10 ## 3     2           3       1                10 ## 4     4           5       1                 9 ## 5     3           4       1                10 ## 6     4           5       1                 9 # Compare the samples with and without secondary censoring to the true # distribution # Calculate empirical CDF empirical_cdf <- ecdf(samples)  # Create a sequence of x values for the theoretical CDF x_seq <- seq(0, 10, length.out = 100)  # Calculate theoretical CDF theoretical_cdf <- pgamma(x_seq, shape = shape, rate = rate)  # Create a long format data frame for plotting cdf_data <- data.frame(   x = rep(x_seq, 2),   probability = c(empirical_cdf(x_seq), theoretical_cdf),   type = rep(c(\"Observed\", \"Theoretical\"), each = length(x_seq)),   stringsAsFactors = FALSE )  # Plot ggplot(cdf_data, aes(x = x, y = probability, color = type)) +   geom_step(linewidth = 1) +   scale_color_manual(     values = c(Observed = \"#4292C6\", Theoretical = \"#252525\")   ) +   geom_vline(     aes(xintercept = mean(samples), color = \"Observed\"),     linetype = \"dashed\", linewidth = 1   ) +   geom_vline(     aes(xintercept = shape / rate, color = \"Theoretical\"),     linetype = \"dashed\", linewidth = 1   ) +   labs(     title = \"Comparison of Observed vs Theoretical CDF\",     x = \"Delay\",     y = \"Cumulative Probability\",     color = \"CDF Type\"   ) +   theme_minimal() +   theme(     panel.grid.minor = element_blank(),     plot.title = element_text(hjust = 0.5),     legend.position = \"bottom\"   ) +   coord_cartesian(xlim = c(0, 10)) # Set x-axis limit to match truncation"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"fitting-a-naive-model-using-fitdistrplus","dir":"Articles","previous_headings":"","what":"Fitting a naive model using fitdistrplus","title":"Fitting distributions using primarycensored and fitdistrplus","text":"first fit naive model using fitdistcens() function. function designed handle secondary censored data handle primary censoring truncation without extension. see naive model fit poorly due primary censoring right truncation data.","code":"fit <- delay_data |>   dplyr::select(left = delay, right = delay_upper) |>   fitdistcens(     distr = \"gamma\",     start = list(shape = 1, rate = 1)   )  summary(fit) ## Fitting of the distribution ' gamma ' By maximum likelihood on censored data  ## Parameters ##        estimate Std. Error ## shape 2.9607131 0.13487956 ## rate  0.7788964 0.03808087 ## Loglikelihood:  -2111.847   AIC:  4227.693   BIC:  4237.509  ## Correlation matrix: ##           shape      rate ## shape 1.0000000 0.9253887 ## rate  0.9253887 1.0000000"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"fitting-an-improved-model-using-primarycensored-and-fitdistrplus","dir":"Articles","previous_headings":"","what":"Fitting an improved model using primarycensored and fitdistrplus","title":"Fitting distributions using primarycensored and fitdistrplus","text":"’ll now fit improved model using primarycensored package. two approaches: Recommended: Use fitdistdoublecens() - convenience wrapper handles complexity Advanced/Educational: Define custom distribution functions manually (shown first understanding)","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"understanding-the-approach-advanced","dir":"Articles","previous_headings":"4 Fitting an improved model using primarycensored and fitdistrplus","what":"Understanding the approach (advanced)","title":"Fitting distributions using primarycensored and fitdistrplus","text":"section shows manually define custom distribution functions. don’t need - fitdistdoublecens() handles automatically. included help understand ’s happening hood. fit using fitdistrplus, need define custom distribution functions account primary censoring truncation. Rather using fitdistcens use fitdist functions handling censoring . Note custom implementation simplicity filtering use data obs_time rather handling varying observation times. means ’re using subset simulated data estimation. see good agreement true estimated parameters higher standard errors due using subset data.","code":"# Define custom distribution functions using primarycensored # The try catch is required by fitdistrplus dpcens_gamma <- function(x, shape, rate) {   result <- tryCatch(     {       dprimarycensored(         x, pgamma,         shape = shape, rate = rate,         pwindow = 1, swindow = 1, D = 8       )     },     error = function(e) {       rep(NaN, length(x))     }   )   return(result) }  ppcens_gamma <- function(q, shape, rate) {   result <- tryCatch(     {       pprimarycensored(         q, pgamma,         shape = shape, rate = rate,         dpwindow = 1, D = 8       )     },     error = function(e) {       rep(NaN, length(q))     }   )   return(result) }  # Fit the model using fitdistcens with custom gamma distribution pcens_fit <- delay_data |>   dplyr::filter(relative_obs_time == 8) |>   dplyr::pull(delay) |>   fitdist(     distr = \"pcens_gamma\",     start = list(shape = 1, rate = 1)   )  summary(pcens_fit) ## Fitting of the distribution ' pcens_gamma ' by maximum likelihood  ## Parameters :  ##        estimate Std. Error ## shape 1.7522811 0.19551646 ## rate  0.4734692 0.08187069 ## Loglikelihood:  -639.2144   AIC:  1282.429   BIC:  1290.003  ## Correlation matrix: ##           shape      rate ## shape 1.0000000 0.9266603 ## rate  0.9266603 1.0000000"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"using-fitdistdoublecens-recommended","dir":"Articles","previous_headings":"4 Fitting an improved model using primarycensored and fitdistrplus","what":"Using fitdistdoublecens() (recommended)","title":"Fitting distributions using primarycensored and fitdistrplus","text":"Rather defining custom functions manually, primarycensored provides fitdistdoublecens() wrapper function handles everything automatically. recommended approach users. Key advantages fitdistdoublecens(): - custom functions needed: Just specify distribution name (e.g., \"gamma\", \"lnorm\", \"weibull\") - Handles varying observation windows: Supports different truncation times (D) primary windows (pwindow) across observations - Familiar interface: Uses column names similar fitdistcens() (left right censoring bounds) - Supports mixed censoring intervals: Different secondary censoring windows across observations handled automatically","code":"fitdistdoublecens_fit <- fitdistdoublecens(   delay_data,   distr = \"gamma\",   start = list(shape = 1, rate = 1),   left = \"delay\",   right = \"delay_upper\",   pwindow = \"pwindow\",   D = \"relative_obs_time\" )  summary(fitdistdoublecens_fit) ## Fitting of the distribution ' pcens_dist ' by maximum likelihood  ## Parameters :  ##        estimate Std. Error ## shape 1.6863057 0.10294344 ## rate  0.4213108 0.03945095 ## Loglikelihood:  -2064.778   AIC:  4133.556   BIC:  4143.371  ## Correlation matrix: ##           shape      rate ## shape 1.0000000 0.9196305 ## rate  0.9196305 1.0000000"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"summary","dir":"Articles","previous_headings":"4 Fitting an improved model using primarycensored and fitdistrplus","what":"Summary","title":"Fitting distributions using primarycensored and fitdistrplus","text":"vignette shown fit distribution using primarycensored conjunction fitdistrplus. key takeaways : Use fitdistdoublecens(): recommended approach users. handles complexity primary censoring, secondary censoring, truncation automatically. Specify distributions name: Pass base distribution name (e.g., \"gamma\", \"lnorm\", \"weibull\") distr parameter. function automatically finds corresponding d p functions. Ignoring censoring causes bias: naive model ignores primary censoring truncation substantially underestimates true distribution parameters. robust Bayesian approach fitting distributions, see vignette(\"fitting-dists--stan\") vignette. flexible delay distribution fitting, see epidist package (uses primarycensored hood).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-fitdistrplus.html","id":"how-you-might-adapt-this-vignette","dir":"Articles","previous_headings":"4 Fitting an improved model using primarycensored and fitdistrplus","what":"How you might adapt this vignette","title":"Fitting distributions using primarycensored and fitdistrplus","text":"vignette uses simulated data, can adapt work: Replace simulation real data: Swap simulated delay_data observations delays primary secondary events Change distribution: Replace \"gamma\" distributions like \"lnorm\", \"weibull\", \"norm\" depending fits data Vary censoring windows: Adjust pwindow swindow match data’s actual primary secondary censoring intervals Handle different truncation times: Use varying values D column observations different maximum observable delays","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"what-are-we-going-to-do-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"What are we going to do in this vignette","title":"Fitting distributions using primarycensored and cmdstan","text":"vignette, ’ll demonstrate use primarycensored conjunction Stan Bayesian inference epidemiological delay distributions. ’ll cover following key points: Simulating censored delay distribution data Fitting naive model using cmdstan Evaluating naive model’s performance Fitting improved model using primarycensored functionality Fitting model using primarycensored’s built cmdstan model. Comparing primarycensored model’s performance naive model","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"what-you-will-learn","dir":"Articles","previous_headings":"1 Introduction","what":"What you will learn","title":"Fitting distributions using primarycensored and cmdstan","text":"end vignette, able : - Understand bias introduced ignoring primary censoring truncation fitting delay distributions - Use pcd_cmdstan_model() pcd_as_stan_data() fit distributions properly account primary censoring, secondary censoring, truncation - Understand Bayesian fitting Stan appropriate versus MLE approaches fitdistrplus","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"what-might-i-need-to-know-before-starting","dir":"Articles","previous_headings":"1 Introduction","what":"What might I need to know before starting","title":"Fitting distributions using primarycensored and cmdstan","text":"vignette builds concepts introduced Getting Started primarycensored vignette assumes familiarity using Stan tools covered use primarycensored Stan vignette.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"packages-used-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"Packages used in this vignette","title":"Fitting distributions using primarycensored and cmdstan","text":"Alongside primarycensored package use cmdstanr package interfacing cmdstan. also use ggplot2 package plotting dplyr data manipulation.","code":"library(primarycensored) library(cmdstanr) library(ggplot2) library(dplyr)"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"simulating-censored-and-truncated-delay-distribution-data","dir":"Articles","previous_headings":"","what":"Simulating censored and truncated delay distribution data","title":"Fitting distributions using primarycensored and cmdstan","text":"’ll start simulating censored truncated delay distribution data. ’ll use rprimarycensored function (actually use rpcens alias brevity).  figure can see impact truncation censoring observed distribution much lower mean (vertical dashed blue line) true/theoretical distribution (vertical dashed black line). modelling aim recover true parameters theoretical distribution observed distribution (.e. recover black lines blue lines). ’ve aggregated data unique combinations pwindow, swindow, obs_time counted number occurrences observed_delay combination. data use fit model.","code":"set.seed(123) # For reproducibility  # Define the number of samples to generate n <- 2000  # Define the true distribution parameters meanlog <- 1.5 sdlog <- 0.75  # Generate varying pwindow, swindow, and obs_time lengths pwindows <- sample.int(2, n, replace = TRUE) swindows <- sample.int(2, n, replace = TRUE) obs_times <- sample(8:10, n, replace = TRUE)  # Function to generate a single sample generate_sample <- function(pwindow, swindow, obs_time) {   rpcens(     1, rlnorm,     meanlog = meanlog, sdlog = sdlog,     pwindow = pwindow, swindow = swindow, D = obs_time   ) }  # Generate samples samples <- mapply(generate_sample, pwindows, swindows, obs_times)  # Create initial data frame delay_data <- data.frame(   pwindow = pwindows,   obs_time = obs_times,   observed_delay = samples, # this is the observed i.e. censored delay   observed_delay_upper = samples + swindows # The upper bound of the delay3   # (i.e. the true delay is between the observed and the upper bound) ) |>   mutate(     observed_delay_upper = pmin(obs_time, observed_delay_upper)   )  head(delay_data) ##   pwindow obs_time observed_delay observed_delay_upper ## 1       1        9              3                    4 ## 2       1        9              4                    5 ## 3       1        8              6                    7 ## 4       2       10              6                    8 ## 5       1       10              8                   10 ## 6       2        8              4                    5 # Aggregate to unique combinations and count occurrences delay_counts <- delay_data |>   summarise(     n = n(),     .by = c(pwindow, obs_time, observed_delay, observed_delay_upper)   )  head(delay_counts) ##   pwindow obs_time observed_delay observed_delay_upper  n ## 1       1        9              3                    4 37 ## 2       1        9              4                    5 31 ## 3       1        8              6                    7 16 ## 4       2       10              6                    8 26 ## 5       1       10              8                   10 22 ## 6       2        8              4                    5 43 # Compare the samples with and without secondary event censoring to the true # distribution # Calculate empirical CDF empirical_cdf <- ecdf(samples)  # Create a sequence of x values for the theoretical CDF x_seq <- seq(min(samples), max(samples), length.out = 100)  # Calculate theoretical CDF theoretical_cdf <- plnorm(x_seq, meanlog = meanlog, sdlog = sdlog)  # Create a long format data frame for plotting cdf_data <- data.frame(   x = rep(x_seq, 2),   probability = c(empirical_cdf(x_seq), theoretical_cdf),   type = rep(c(\"Observed\", \"Theoretical\"), each = length(x_seq)),   stringsAsFactors = FALSE )  # Plot ggplot(cdf_data, aes(x = x, y = probability, color = type)) +   geom_step(linewidth = 1) +   scale_color_manual(     values = c(Observed = \"#4292C6\", Theoretical = \"#252525\")   ) +   geom_vline(     aes(xintercept = mean(samples), color = \"Observed\"),     linetype = \"dashed\", linewidth = 1   ) +   geom_vline(     aes(xintercept = exp(meanlog + sdlog^2 / 2), color = \"Theoretical\"),     linetype = \"dashed\", linewidth = 1   ) +   labs(     title = \"Comparison of Observed vs Theoretical CDF\",     x = \"Delay\",     y = \"Cumulative Probability\",     color = \"CDF Type\"   ) +   theme_minimal() +   theme(     panel.grid.minor = element_blank(),     plot.title = element_text(hjust = 0.5),     legend.position = \"bottom\"   )"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"fitting-a-naive-model-using-cmdstan","dir":"Articles","previous_headings":"","what":"Fitting a naive model using cmdstan","title":"Fitting distributions using primarycensored and cmdstan","text":"’ll start fitting naive model using cmdstan. ’ll use cmdstanr package interface cmdstan. define model string write file use primarycensored Stan vignette. Now let’s compile model now let’s fit compiled model. may see warning NAs introduced coercion can ignored artefact simple example model. see model converged diagnostics look good. However, just model posterior summary see might happy fit. mu smaller target 1.5 sigma larger target 0.75. Note mu sigma parameters meanlog sdlog parameters lognormal distribution.","code":"writeLines(   \"data {     int<lower=0> N;  // number of observations     vector[N] y;     // observed delays     vector[N] n;     // number of occurrences for each delay   }   parameters {     real mu;     real<lower=0> sigma;   }   model {     // Priors     mu ~ normal(1, 1);     sigma ~ normal(0.5, 1);      // Likelihood     target += n .* lognormal_lpdf(y | mu, sigma);   }\",   con = file.path(tempdir(), \"naive_lognormal.stan\") ) naive_model <- cmdstan_model(file.path(tempdir(), \"naive_lognormal.stan\")) naive_fit <- naive_model$sample(   data = list(     # Add a small constant to avoid log(0)     y = delay_counts$observed_delay + 1e-6,     n = delay_counts$n,     N = nrow(delay_counts)   ),   chains = 4,   parallel_chains = 4,   refresh = ifelse(interactive(), 50, 0),   show_messages = interactive() ) naive_fit ##  variable       mean     median   sd  mad         q5        q95 rhat ess_bulk ##     lp__  -381721.38 -381721.10 0.99 0.76 -381723.44 -381720.42 1.00     1817 ##     mu         -0.60      -0.60 0.01 0.01      -0.62      -0.58 1.00     1601 ##     sigma       5.10       5.10 0.01 0.01       5.08       5.11 1.00     3935 ##  ess_tail ##      2101 ##      1882 ##      2752"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"fitting-an-improved-model-using-primarycensored","dir":"Articles","previous_headings":"","what":"Fitting an improved model using primarycensored","title":"Fitting distributions using primarycensored and cmdstan","text":"’ll now fit improved model using primarycensored package. main improvement use primarycensored_lpdf function fit model. Stan version pcens() function adjusts primary secondary censoring windows well truncation. encode primary distribution lognormal distribution passing 1 dist_id parameter primary event distribution uniform passing 1 primary_id parameter. See Stan documentation details primarycensored_lpdf function. Now let’s compile model Now let’s fit compiled model. see model converged diagnostics look good. also see posterior means near true parameters 90% credible intervals include true parameters.","code":"writeLines(   \"   functions {     #include primarycensored.stan     // These functions are required for the primarycensored_lpdf function     #include primarycensored_ode.stan     #include primarycensored_analytical_cdf.stan     #include expgrowth.stan   }   data {     int<lower=0> N;  // number of observations     array[N] int<lower=0> y;     // observed delays     array[N] int<lower=0> y_upper;     // observed delays upper bound     array[N] int<lower=0> n;     // number of occurrences for each delay     array[N] int<lower=0> pwindow; // primary censoring window     array[N] int<lower=0> D; // maximum delay   }   transformed data {     array[0] real primary_params;   }   parameters {     real mu;     real<lower=0> sigma;   }   model {     // Priors     mu ~ normal(1, 1);     sigma ~ normal(0.5, 0.5);      // Likelihood     for (i in 1:N) {       target += n[i] * primarycensored_lpmf(         y[i] | 1, {mu, sigma},         pwindow[i], y_upper[i], D[i],         1, primary_params       );     }   }\",   con = file.path(tempdir(), \"primarycensored_lognormal.stan\") ) primarycensored_model <- cmdstan_model(   file.path(tempdir(), \"primarycensored_lognormal.stan\"),   include_paths = pcd_stan_path() ) primarycensored_fit <- primarycensored_model$sample(   data = list(     y = delay_counts$observed_delay,     y_upper = delay_counts$observed_delay_upper,     n = delay_counts$n,     pwindow = delay_counts$pwindow,     D = delay_counts$obs_time,     N = nrow(delay_counts)   ),   chains = 4,   parallel_chains = 4,   refresh = ifelse(interactive(), 50, 0),   show_messages = interactive() ) primarycensored_fit ##  variable     mean   median   sd  mad       q5      q95 rhat ess_bulk ess_tail ##     lp__  -3422.81 -3422.47 1.09 0.75 -3424.97 -3421.80 1.00     1316     1453 ##     mu        1.55     1.54 0.05 0.05     1.47     1.63 1.01     1072     1211 ##     sigma     0.78     0.78 0.03 0.03     0.73     0.84 1.01     1121     1281"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"using-pcd_cmdstan_model-for-a-more-efficient-approach","dir":"Articles","previous_headings":"","what":"Using pcd_cmdstan_model() for a more efficient approach","title":"Fitting distributions using primarycensored and cmdstan","text":"previous approach works well, primarycensored provides efficient convenient model can compile using pcd_cmdstan_model(). approach saves time model specification also leverages within chain parallelisation make best use machine’s resources. Alongside also supply convenience function pcd_as_stan_data() convert data format can used fit model supply priors, bounds, settings. Let’s use function fit data: model generic params vector contains parameters delay distribution. case mu sigma last example (.e. meanlog sdlog parameters lognormal distribution). also primary_params vector contains parameters primary distribution. case empty using uniform distribution. see model converged diagnostics look good. also see posterior means near true parameters 90% credible intervals include true parameters manually written model. Note set parallel_chains = 2 threads_per_chain = 2 demonstrate within chain parallelisation. Usually however want use parallel_chains = <number chains> use remainder available cores within chain parallelisation setting threads_per_chain = <remaining cores / number chains> ensure make best use machine’s resources.","code":"# Compile the model with multithreading support pcd_model <- pcd_cmdstan_model(cpp_options = list(stan_threads = TRUE))  pcd_data <- pcd_as_stan_data(   delay_counts,   delay = \"observed_delay\",   delay_upper = \"observed_delay_upper\",   relative_obs_time = \"obs_time\",   dist_id = pcd_stan_dist_id(\"lognormal\", \"delay\"),   primary_id = pcd_stan_dist_id(\"uniform\", \"primary\"),   param_bounds = list(lower = c(-Inf, 0), upper = c(Inf, Inf)),   primary_param_bounds = list(lower = numeric(0), upper = numeric(0)),   priors = list(location = c(1, 0.5), scale = c(1, 0.5)),   primary_priors = list(location = numeric(0), scale = numeric(0)),   use_reduce_sum = TRUE # use within chain parallelisation )  pcd_fit <- pcd_model$sample(   data = pcd_data,   chains = 4,   parallel_chains = 2, # Run 2 chains in parallel   threads_per_chain = 2, # Use 2 cores per chain   refresh = ifelse(interactive(), 50, 0),   show_messages = interactive() )  pcd_fit ##   variable     mean   median   sd  mad       q5      q95 rhat ess_bulk ess_tail ##  lp__      -3422.74 -3422.42 0.99 0.72 -3424.69 -3421.79 1.00     1501     1558 ##  params[1]     1.55     1.54 0.05 0.04     1.48     1.63 1.01      972     1214 ##  params[2]     0.78     0.78 0.03 0.03     0.73     0.84 1.01      957     1243"},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"summary","dir":"Articles","previous_headings":"5 Using pcd_cmdstan_model() for a more efficient approach","what":"Summary","title":"Fitting distributions using primarycensored and cmdstan","text":"vignette shown fit delay distribution using primarycensored conjunction cmdstan. key takeaways : Use pcd_cmdstan_model() pcd_as_stan_data(): recommended approach users. handles complexity primary censoring, secondary censoring, truncation automatically, supports within-chain parallelisation. Specify distributions ID: Use pcd_stan_dist_id() get correct distribution identifier (e.g., \"lognormal\", \"gamma\", \"weibull\"). Ignoring censoring causes bias: naive model ignores primary censoring truncation substantially underestimates true distribution parameters. faster MLE-based approach doesn’t require Stan, see vignette(\"fitting-dists--fitdistrplus\") vignette. flexible delay distribution fitting, see epidist package (uses primarycensored hood).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/fitting-dists-with-stan.html","id":"how-you-might-adapt-this-vignette","dir":"Articles","previous_headings":"5 Using pcd_cmdstan_model() for a more efficient approach","what":"How you might adapt this vignette","title":"Fitting distributions using primarycensored and cmdstan","text":"vignette uses simulated data, can adapt work: Replace simulation real data: Swap simulated delay_data observations delays primary secondary events Change distribution: Replace \"lognormal\" distributions like \"gamma\" \"weibull\" using pcd_stan_dist_id() Vary censoring windows: Adjust pwindow values match data’s actual primary censoring intervals Handle different truncation times: Use varying values obs_time column observations different maximum observable delays Modify priors: Adjust priors argument pcd_as_stan_data() reflect prior knowledge distribution parameters","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/primarycensored.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with primarycensored","text":"Delay distributions play crucial role various fields, including epidemiology, reliability analysis, survival analysis. distributions describe time two events interest, incubation period disease time failure component. Accurately estimating calculating distributions essential understanding underlying processes making informed decisions[1]. However, estimating distributions can challenging due various factors, including censoring truncation observed data[2]. estimation delay distributions often faces following challenges: Primary event censoring: primary event (e.g., exposure pathogen start process) often observed degree interval censoring. means exact time event known, rather, known occurred within certain time interval, commonly day. result, distribution based primary events combination underlying true distribution censoring distribution. Truncation: observation delay distributions often conditioned occurrence secondary event. leads truncation observed distribution, delays longer observation time captured data. Consequently, observed distribution combination underlying true distribution, censoring distribution, observation time. Secondary event censoring: secondary event (e.g., symptom onset end process) also frequently observed interval censoring. additional layer censoring complicates estimation delay distribution. primarycensored package aims address challenges providing tools manipulate primary censored delay distributions extend distributions account truncation secondary event censoring. accounting censoring truncation present data, package enables accurate estimation use underlying true distribution. vignette, provide quick introduction main functions concepts primarycensored package. cover mathematical formulation problem, demonstrate usage key functions, provide signposting learn .","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/primarycensored.html","id":"packages-in-this-getting-started-vignette-","dir":"Articles","previous_headings":"","what":"Packages in this getting started vignette.","title":"Getting Started with primarycensored","text":"well primarycensored package vignette also uses ggplot2 plotting.","code":"# Load packages library(primarycensored) library(ggplot2) # Set seed for reproducibility set.seed(123)"},{"path":"https://primarycensored.epinowcast.org/dev/articles/primarycensored.html","id":"generating-random-samples-with-rprimarycensored","dir":"Articles","previous_headings":"","what":"Generating random samples with rprimarycensored()","title":"Getting Started with primarycensored","text":"function generates random samples , potentially truncated, primary event censored distribution. adjusts distribution accounting primary event distribution, potential truncation maximum delay (\\(D\\)), secondary event censoring. mathematical formulation generating random samples primary event censored distribution follows: Generate primary event times (\\(p\\)) specified primary event distribution (\\(f_p\\)) parameters \\(\\phi\\), defined 0 primary event window (\\(pwindow\\)): \\[p \\sim f_p(\\phi), \\quad p \\[0, pwindow]\\] Generate delays (\\(d\\)) specified delay distribution (\\(f_d\\)) parameters \\(\\theta\\): \\[d \\sim f_d(\\theta), \\quad d \\geq 0\\] Calculate total delays (\\(t\\)) adding primary event times delays: \\[t = p + d\\] Apply truncation (.e. remove delays fall outside observation window) ensure delays within specified range \\([0, D]\\), \\(D\\) maximum observable delay: \\[t_{truncated} = \\{t \\mid 0 \\leq t < D\\}\\] Round truncated delays nearest secondary event window (\\(swindow\\)): \\[t_{valid} = \\lfloor \\frac{t_{truncated}}{swindow} \\rfloor \\times swindow\\] ’s example use rprimarycensored() sample log-normal distribution without secondary event interval censoring. simplicity use daily censoring window events assume uniform primary event distribution. However, package supports mix censoring intervals wide range primary delay distributions.  Neither distribution matches true distribution due truncation D biases observed distributions towards shorter delays, well primary secondary event censoring.","code":"n <- 1e4 meanlog <- 1.5 sdlog <- 0.75 obs_time <- 10 pwindow <- 1  # Random samples without secondary event censoring samples <- rprimarycensored(   n,   rdist = rlnorm, rprimary = runif,   pwindow = pwindow, swindow = 0, D = obs_time,   meanlog = meanlog, sdlog = sdlog ) # Random samples with secondary event censoring samples_sc <- rprimarycensored(   n,   rdist = rlnorm, rprimary = runif,   pwindow = pwindow, swindow = 1, D = obs_time,   meanlog = meanlog, sdlog = sdlog ) # Calculate the PMF for the samples with secondary event censoring samples_sc_pmf <- data.frame(   pmf =     table(samples_sc) /       sum(table(samples_sc)) ) # Compare the samples with and without secondary event censoring # to the true distribution ggplot() +   geom_density(     data = data.frame(samples = samples),     aes(x = samples),     fill = \"#4292C6\",     col = \"#252525\",     alpha = 0.5   ) +   geom_col(     data = samples_sc_pmf,     aes(       x = as.numeric(as.character(pmf.samples_sc)),       y = pmf.Freq     ),     fill = \"#20b986\",     col = \"#252525\",     alpha = 0.5,     width = 0.9,     just = 0   ) +   geom_function(     fun = dlnorm,     args = list(meanlog = meanlog, sdlog = sdlog),     color = \"#252525\",     linewidth = 1   ) +   labs(     title = \"Comparison of Samples from Log-Normal Distribution\",     x = \"Delay\",     y = \"Density\",     caption = paste0(       \"Blue density: Truncated samples without secondary event censoring\\n\",       \"Green bars: Truncated samples with secondary event censoring\\n\",       \"Black line: True log-normal distribution without truncation\"     )   ) +   scale_x_continuous(limits = c(0, 15)) +   scale_y_continuous(     expand = expansion(mult = c(0, 0.05))   ) +   theme_minimal() +   theme(     panel.grid.minor = element_blank(),     plot.title = element_text(hjust = 0.5)   )"},{"path":"https://primarycensored.epinowcast.org/dev/articles/primarycensored.html","id":"compute-the-primary-event-censored-cumulative-distribution-function-cdf-for-delays-with-pprimarycensored","dir":"Articles","previous_headings":"","what":"Compute the primary event censored cumulative distribution function (CDF) for delays with pprimarycensored()","title":"Getting Started with primarycensored","text":"function computes primary event censored cumulative distribution function (CDF) given set quantiles. adjusts CDF delay distribution accounting primary event distribution potential truncation maximum delay (\\(D\\)). useful want understand probability delay less equal certain value, taking account primary event distribution truncation data. primary event censored CDF, (\\(F_{\\text{cens}}(q)\\)), given : \\[ F_{\\text{cens}}(q) = \\int_{0}^{pwindow} F(q - p) \\cdot f_{\\text{primary}}(p) \\, dp \\] \\(F\\) CDF delay distribution, \\(f_{\\text{primary}}\\) PDF primary event times, \\(pwindow\\) primary event window. maximum delay \\(D\\) finite, CDF normalized dividing \\(F_{\\text{cens}}(D)\\): \\[ F_{\\text{cens,norm}}(q) = \\frac{F_{\\text{cens}}(q)}{F_{\\text{cens}}(D)} \\] \\(F_{\\text{cens,norm}}(q)\\) normalized CDF. Let’s compare empirical CDF samples without secondary event censoring theoretical CDF computed using pprimarycensored():  theoretical CDF matches empirical CDF well, confirming pprimarycensored() working expected.","code":"empirical_cdf <- ecdf(samples) theoretical_cdf <- pprimarycensored(   seq(0, obs_time, length.out = 100),   pdist = plnorm, dprimary = dunif,   pwindow = pwindow, D = obs_time,   meanlog = meanlog, sdlog = sdlog )  # Create a data frame for plotting cdf_data <- data.frame(   x = seq(0, obs_time, length.out = 100),   Theoretical = theoretical_cdf,   Empirical = empirical_cdf(seq(0, obs_time, length.out = 100)) )  # Plot the empirical and theoretical CDFs ggplot(cdf_data, aes(x = x)) +   geom_step(aes(y = Theoretical), color = \"black\", linewidth = 1) +   geom_step(aes(y = Empirical), color = \"#4292C6\", linewidth = 1) +   labs(     title = \"Comparison of Empirical and Theoretical CDFs\",     x = \"Delay\",     y = \"Cumulative Probability\",     caption = paste0(       \"Blue line: Empirical CDF from samples without secondary        event  censoring\\n\",       \"Black line: Theoretical CDF computed using pprimarycensored()\"     )   ) +   scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +   theme_minimal() +   theme(     panel.grid.minor = element_blank(),     plot.title = element_text(hjust = 0.5)   )"},{"path":"https://primarycensored.epinowcast.org/dev/articles/primarycensored.html","id":"compute-the-primary-event-censored-probability-mass-function-pmf-with-dprimarycensored","dir":"Articles","previous_headings":"","what":"Compute the primary event censored probability mass function (PMF) with dprimarycensored()","title":"Getting Started with primarycensored","text":"function computes primary event censored probability mass function (PMF) given set quantiles using CDF. top accounting primary event distribution truncation, also adjusts secondary event censoring. particularly useful working discrete data want understand probability observing delays specific time windows, daily reporting delays. primary event censored PMF, (\\(f_{\\text{cens}}(d)\\)), given : \\[ f_{\\text{cens}}(d) = F_{\\text{cens}}(d + \\text{swindow}) - F_{\\text{cens}}(d) \\] (\\(F_{\\text{cens}}\\)) potentially right truncated primary event censored CDF (\\(\\text{swindow}\\)) secondary event window. Let’s compare empirical PMF samples secondary event censoring theoretical PMF computed using dprimarycensored():  theoretical PMF matches empirical PMF well, confirming dprimarycensored() also working expected.","code":"# Calculate the theoretical PMF using dprimarycensored theoretical_pmf <- dprimarycensored(   0:(obs_time - 1),   pdist = plnorm, dprimary = dunif,   pwindow = pwindow, swindow = 1, D = obs_time,   meanlog = meanlog, sdlog = sdlog )  pmf_df <- data.frame(   x = 0:obs_time,   pmf = c(theoretical_pmf, 0) )  # Plot the empirical and theoretical PMFs ggplot() +   geom_col(     data = samples_sc_pmf,     aes(       x = as.numeric(as.character(pmf.samples_sc)),       y = pmf.Freq     ),     fill = \"#20b986\",     col = \"#252525\",     alpha = 0.5,     width = 0.9,     just = 0   ) +   geom_step(     data = pmf_df,     aes(x = x, y = pmf),     color = \"black\",     linewidth = 1   ) +   labs(     title = \"Comparison of Samples from Log-Normal Distribution\",     x = \"Delay\",     y = \"Density\",     caption = paste0(       \"Green bars: Empirical PMF from samples with secondary event censoring\\n\",       \"Black line: Theoretical PMF computed using dprimarycensored()\"     )   ) +   scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +   theme_minimal() +   theme(     panel.grid.minor = element_blank(),     plot.title = element_text(hjust = 0.5)   )"},{"path":"https://primarycensored.epinowcast.org/dev/articles/primarycensored.html","id":"other-key-functionality","dir":"Articles","previous_headings":"","what":"Other key functionality","title":"Getting Started with primarycensored","text":"addition main functions, package also includes: Primary event distributions: package includes commonly used primary event distributions exponential growth. Built-estimation tools: package provides functionality estimate delay distributions censored truncated data using Stan fitdistrplus. tools make easy fit models without implement likelihood functions . Analytical solutions: common combinations primary event delay distributions (e.g., uniform primary events gamma, lognormal, Weibull delays), package includes analytical solutions provide significant computational speedups compared numerical integration. Stan versions functions R functions interface Stan: R functions corresponding Stan function. Stan functions used estimation delay distributions using Stan software. package also includes tools manipulate Stan code R.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/primarycensored.html","id":"learning-more","dir":"Articles","previous_headings":"","what":"Learning more","title":"Getting Started with primarycensored","text":"primarycensored see package vignettes function documentation. detailed explanation mathematical formulation primary event censored distribution see vignette(\"--works\"). mathematical details analytic solutions see vignette(\"analytic-solutions\"). methodological background delay distributions see Park et al.[2]. advice best practices estimating handling delay distributions see Charniga et al.[1].","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"what-are-we-going-to-do-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"What are we going to do in this vignette","title":"How to use primarycensored with Stan","text":"vignette, ’ll explore use primarycensored package Stan modelling workflow. ’ll cover following key points: Introduction Stan relevance analysis Overview packages ’ll using access use Stan functions provided primarycensored Methods integrating Stan functions workflow instead interested fitting delay distribution using primarycensored R see vignette(\"fitting-dists--stan\") vignette epidist package (uses primarycensored hood).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"what-is-stan-and-why-are-we-using-it","dir":"Articles","previous_headings":"1 Introduction","what":"What is Stan and why are we using it","title":"How to use primarycensored with Stan","text":"Stan probabilistic programming language statistical inference. provides flexible efficient platform Bayesian modeling widely used various fields data science statistics. vignette, ’ll use Stan conjunction primarycensored perform Bayesian inference censored data. information Stan: Stan’s official website Stan documentation Stan forums community support discussions","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"packages-used-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"Packages used in this vignette","title":"How to use primarycensored with Stan","text":"Alongside primarycensored package use cmdstanr package interfacing cmdstan.","code":"library(primarycensored) library(cmdstanr)"},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"using-stan-code-in-primarycensored","dir":"Articles","previous_headings":"","what":"Using Stan code in primarycensored","title":"How to use primarycensored with Stan","text":"primarycensored includes set Stan functions mirror R functions primarycensored. Documentation functions can found . support range approaches integrate Stan code workflow.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"checking-available-stan-functions-using-pcd_stan_functions","dir":"Articles","previous_headings":"2 Using Stan code in primarycensored","what":"Checking available Stan functions using pcd_stan_functions()","title":"How to use primarycensored with Stan","text":"Aside reading documentation also possible list available Stan functions using helper function directly R.","code":"pcd_stan_functions() ##  [1] \"expgrowth_pdf\"                          ##  [2] \"expgrowth_lpdf\"                         ##  [3] \"expgrowth_cdf\"                          ##  [4] \"expgrowth_lcdf\"                         ##  [5] \"expgrowth_rng\"                          ##  [6] \"check_for_analytical\"                   ##  [7] \"primarycensored_gamma_uniform_lcdf\"     ##  [8] \"primarycensored_lognormal_uniform_lcdf\" ##  [9] \"log_weibull_g\"                          ## [10] \"primarycensored_weibull_uniform_lcdf\"   ## [11] \"primarycensored_analytical_lcdf\"        ## [12] \"primarycensored_analytical_cdf\"         ## [13] \"dist_lcdf\"                              ## [14] \"primary_lpdf\"                           ## [15] \"primarycensored_ode\"                    ## [16] \"primarycensored_cdf\"                    ## [17] \"primarycensored_lcdf\"                   ## [18] \"primarycensored_lpmf\"                   ## [19] \"primarycensored_pmf\"                    ## [20] \"primarycensored_sone_lpmf_vectorized\"   ## [21] \"primarycensored_sone_pmf_vectorized\""},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"accessing-stan-functions","dir":"Articles","previous_headings":"2 Using Stan code in primarycensored","what":"Accessing Stan functions","title":"How to use primarycensored with Stan","text":"Stan functions accessed using pcd_load_stan_functions() function. function takes name function argument returns function string. can additionally write functions file wrap functions{} block.","code":"pcd_load_stan_functions(\"primarycensored_lpmf\") ## [1] \"// Stan functions from primarycensored version 1.2.0.1000\\nreal primarycensored_lpmf(data int d, int dist_id, array[] real params,\\n                                data real pwindow, data real d_upper,\\n                                data real D, int primary_id,\\n                                array[] real primary_params) {\\n  if (d_upper > D) {\\n    reject(\\\"Upper truncation point is greater than D. It is \\\", d_upper,\\n           \\\" and D is \\\", D, \\\". Resolve this by increasing D to be greater or equal to d + swindow or decreasing swindow.\\\");\\n  }\\n  if (d_upper <= d) {\\n    reject(\\\"Upper truncation point is less than or equal to d. It is \\\", d_upper,\\n           \\\" and d is \\\", d, \\\". Resolve this by increasing d to be less than d_upper.\\\");\\n  }\\n  real log_cdf_upper = primarycensored_lcdf(\\n    d_upper | dist_id, params, pwindow, positive_infinity(), primary_id, primary_params\\n  );\\n  real log_cdf_lower = primarycensored_lcdf(\\n    d | dist_id, params, pwindow, positive_infinity(), primary_id, primary_params\\n  );\\n  if (!is_inf(D)) {\\n    real log_cdf_D;\\n\\n    if (d_upper == D) {\\n      log_cdf_D = log_cdf_upper;\\n    } else {\\n      log_cdf_D = primarycensored_lcdf(\\n        D | dist_id, params, pwindow, positive_infinity(), primary_id, primary_params\\n      );\\n    }\\n    return log_diff_exp(log_cdf_upper, log_cdf_lower) - log_cdf_D;\\n  } else {\\n    return log_diff_exp(log_cdf_upper, log_cdf_lower);\\n  }\\n}\""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"writing-functions-to-a-file","dir":"Articles","previous_headings":"2 Using Stan code in primarycensored > 2.3 Linking the Stan functions to your workflow","what":"Writing functions to a file","title":"How to use primarycensored with Stan","text":"One option using Stan functions write file compile using cmdstanr. good approach means functions written can used way stan functions might use. downside may mean work keeping date changes functions. can using pcd_load_stan_functions() function. can now compiled used way cmdstanr model. Alternatively, use #include expgrowth_rng.stan stan file functions block include function along path file stan file (see ).","code":"expgrowth_rng_file <- file.path(tempdir(), \"expgrowth_rng.stan\") exp_model <- pcd_load_stan_functions(   \"expgrowth_rng\",   write_to_file = TRUE,   output_file = expgrowth_rng_file,   wrap_in_block = TRUE ) ## Stan functions written to: /tmp/RtmpR4odjr/expgrowth_rng.stan model <- cmdstan_model(expgrowth_rng_file) model ## functions { ## // Stan functions from primarycensored version 1.2.0.1000 ## real expgrowth_rng(real min, real max, real r) { ##   real u = uniform_rng(0, 1); ##   if (abs(r) < 1e-10) { ##     return min + u * (max - min); ##   } ##   return min + log(u * (exp(r * max) - exp(r * min)) + exp(r * min)) / r; ## } ## }"},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"including-the-functions-directly-via-include_paths","dir":"Articles","previous_headings":"2 Using Stan code in primarycensored > 2.3 Linking the Stan functions to your workflow","what":"Including the functions directly via include_paths","title":"How to use primarycensored with Stan","text":"Rather writing functions file also possible include directly stan file using include_paths argument cmdstan_model(). useful don’t clutter model stan code primarycensored want automatic updating functions. demonstrate first write small model expgrowth.stan include paths (rather writing file including ). first step find file path expgrowth_rng function. done now write stan wrapper model. can now use file compile model. Note need include path primarycensored Stan functions using include_paths argument cmdstan_model(). can sample model (set fixed_param = TRUE toy example doesn’t require MCMC sampling).","code":"pcd_stan_files(\"expgrowth_rng\") ## [1] \"expgrowth.stan\" expgrowth_stan_file <- file.path(tempdir(), \"expgrowth.stan\") writeLines(   text = c(     \"functions {\",     \"#include expgrowth.stan\",     \"}\",     \"generated quantities {\",     \"  real y = expgrowth_rng(0, 1, 0.4);\",     \"}\"   ),   con = expgrowth_stan_file ) model <- cmdstan_model(expgrowth_stan_file, include_paths = pcd_stan_path()) model ## functions { ## #include expgrowth.stan ## } ## generated quantities { ##   real y = expgrowth_rng(0, 1, 0.4); ## } samples <- model$sample(chains = 1, fixed_param = TRUE) ## Running MCMC with 1 chain... ##  ## Chain 1 Iteration:   1 / 1000 [  0%]  (Sampling)  ## Chain 1 Iteration: 100 / 1000 [ 10%]  (Sampling)  ## Chain 1 Iteration: 200 / 1000 [ 20%]  (Sampling)  ## Chain 1 Iteration: 300 / 1000 [ 30%]  (Sampling)  ## Chain 1 Iteration: 400 / 1000 [ 40%]  (Sampling)  ## Chain 1 Iteration: 500 / 1000 [ 50%]  (Sampling)  ## Chain 1 Iteration: 600 / 1000 [ 60%]  (Sampling)  ## Chain 1 Iteration: 700 / 1000 [ 70%]  (Sampling)  ## Chain 1 Iteration: 800 / 1000 [ 80%]  (Sampling)  ## Chain 1 Iteration: 900 / 1000 [ 90%]  (Sampling)  ## Chain 1 Iteration: 1000 / 1000 [100%]  (Sampling)  ## Chain 1 finished in 0.0 seconds. samples ##  variable mean median   sd  mad   q5  q95 rhat ess_bulk ess_tail ##         y 0.52   0.54 0.29 0.37 0.06 0.95 1.00      979      802"},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"using-stan-functions-directly-in-r","dir":"Articles","previous_headings":"2 Using Stan code in primarycensored","what":"Using Stan functions directly in R","title":"How to use primarycensored with Stan","text":"Whilst possible use Stan functions directly R recommended use cases (use R functions primarycensored instead). However, can useful understand going hood exploration (indeed use internally primarycensored check functions R implementations). use expose_functions() method already compiled model. can take time (~30 seconds) compile functions. can now use function R. Note may get slightly complicated stan function depends stan functions (.e. need included compiled model well).","code":"model$expose_functions(global = TRUE) expgrowth_rng(0, 1, 0.4) ## [1] 0.1772395"},{"path":"https://primarycensored.epinowcast.org/dev/articles/using-stan-tools.html","id":"summary","dir":"Articles","previous_headings":"2 Using Stan code in primarycensored","what":"Summary","title":"How to use primarycensored with Stan","text":"vignette shown approaches using Stan functions provided primarycensored Stan modelling workflow. also shown use expose_functions() method access Stan functions directly R exploration testing.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"what-are-we-going-to-do-in-this-vignette","dir":"Articles","previous_headings":"1 Introduction","what":"What are we going to do in this vignette","title":"Why it works","text":"vignette, ’ll explain statistical model primarycensored package based . ’ll cover following key points: Introduction censored data problems time event analysis. Discuss relevant issues censoring epidemiological data. Introduce statistical model used primarycensored. Distributions can derive censored delay distribution analytically. new package, recommend start vignette(\"primarycensored\") vignette.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"censoring-and-right-truncation-problems-in-time-to-event-analysis","dir":"Articles","previous_headings":"","what":"Censoring and right truncation problems in time to event analysis","title":"Why it works","text":"Time--event analysis, also known survival analysis, concerns estimating distribution delay times events. distinctive feature field methodological techniques used deal missing data problems common data sets delay times[1]. primarycensored focus two particular missing data problems: Interval censoring. primary (start) time /secondary (end) time delay unobserved known within intervals. Right truncation. Truncated delay data items reported secondary events less known time, example current data collection time. statistical epidemiology, missing data problems occur frequently data analysis theoretical modelling. detailed description problems epidemiological context see[2,3]. data analysis, events epidemiology commonly reported occurring particular day week (interval censoring). emerging outbreak, datasets can incompletely observed (right truncation) can great deal uncertainty around precise timing events (interval censoring). theoretical epidemiological modelling, often appropriate model evolution infectious disease occurring discrete time, example EpiNow2 EpiEstim modelling packages. means appropriately discretising continuous distributions, generation interval distribution. primarycensored treat discretisation intrinsically continuous distributions interval censoring problem allows us simultaneously provide methods applied theoretical contexts.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"statistical-model-used-in-primarycensored","dir":"Articles","previous_headings":"","what":"Statistical model used in primarycensored","title":"Why it works","text":"described Getting Started primarycensored, primarycensored focuses subset methods time event analysis address data missingness problems commonly found epidemiological datasets. present statistical problem double interval censoring problem, primary event time secondary event times interval censored. can recover single interval censoring problems reducing one intervals point. particular, methods primarycensored start assuming secondary event censoring solving primary censoring problem. reason packages name despite common use case double censoring. key assumption make throughout censoring window events known independent event time within censoring interval. known non-informative censoring. target inference distribution delay time primary secondary events. assume delay time random variable \\(T = S - P_{u}\\) distribution function \\(F_T(t) = Pr(T < t)\\) density function \\(f_T(t)\\). treatment assume delay time shift-invariant, , distribution delay time regardless primary event time. (unconditional) primary event time random variable \\(P_{u}\\) distribution function \\(F_{P_{u}}(t)\\) density function \\(f_{P_{u}}(t)\\). secondary event time random variable \\(S\\), treatment construct secondary event time primary time delay, therefore marginal distribution \\(S\\) considered. censoring window event interval within event known occurred, respectively, \\(P \\[t_P, t_P + w_P]\\) \\(S \\[t_S, t_S + w_S]\\). lengths censoring windows \\(w_P\\) \\(w_S\\) respectively. precise event times within windows unobserved. Note since primary event time known censoring window, predominantly interested conditional primary time \\(P = P_{u} | \\{ P_{u} \\[t_P, t_P + w_P]\\}\\) density function: \\[ \\begin{aligned} f_{P}(p) &= {f_{P_{u}}(p) \\F_{P_{u}}(t_P + w_P) - F_{P_{u}}(t_P)}, \\qquad &p \\[t_P, t_P + w_P],\\\\ f_{P}(p) &= 0, \\qquad &\\text{otherwise}. \\end{aligned} \\] note, measure censored delay time \\(T_c\\) primary secondary event windows endpoint endpoint: \\(T_c = t_S + w_S - (t_P + w_P)\\). Note generative model delays “Getting started” truncated delay \\(t_{\\text{valid}}\\) measured startpoint startpoint event windows. treatment focus survival function time end primary window secondary event time denote \\(S_{+}\\). use derive distribution censored delay time \\(T_c\\). equivalent , differs mathematical approach treatments censoring problems epidemiology, [2], see section Connections approaches details.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"censored-delay-time-distribution","dir":"Articles","previous_headings":"3 Statistical model used in primarycensored","what":"Censored delay time distribution","title":"Why it works","text":"section, explain derive distribution censored delay time \\(T_c\\) distribution delay time \\(T\\) condition distribution primary event time \\(P\\).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"survival-function-of-time-from-the-end-of-the-primary-censoring-window-to-the-secondary-event-time","dir":"Articles","previous_headings":"3 Statistical model used in primarycensored > 3.1 Censored delay time distribution","what":"Survival function of time from the end of the primary censoring window to the secondary event time","title":"Why it works","text":"reasoning distribution censored delay time \\(T_c\\), useful consider time end (right) point primary censoring interval secondary time random variable, \\[ S_+ = S - (t_P + w_P) = T - ((t_P + w_P) - P) = T - C_P. \\] \\(T\\) delay distribution interest \\(C_P = (t_P + w_P) - P\\) interval end (right) point primary censoring window primary event time; note definition \\(C_P\\) observed can relate distribution distribution \\(P\\): \\(F_{C_P}(p) = Pr(C_P < p) = Pr(P > t_P + w_P - p)\\). non-informative censoring, possible derive upper distribution function \\(S_+\\), survival function \\(S_+\\), distribution \\(T\\) distribution \\(C_P\\). \\[ \\begin{equation} \\begin{split} Q_{S_+}(t) &= Pr(S_+ > t) \\\\ &= Pr(T > C_P + t) \\\\ &= \\mathbb{E}_{C_P} \\Big[Q_T(t + C_P)\\Big] \\\\ &= \\int_0^{w_P} Q_T(t + p) f_{C_P}(p) dp. \\end{split} \\end{equation} \\] Using integration parts gives: \\[ Q_{S_+}(t) = Q_T(t + w_P) + \\int_0^{w_P} f_T(t+p) F_{C_P}(p) dp. \\tag{3.1} \\] used \\(Q^{'}_{T} = - f_T\\), \\(Q_T\\) survival function actual delay distribution interest \\(w_P\\) length primary censoring window. Equation (3.1) key equation note used derive distribution censored delay time \\(T_c\\). interpretation probability secondary event time greater \\(t\\) end primary censoring window sum two disjoint event probabilities: probability actual delay time \\(T\\) greater \\(t + w_P\\). probability actual delay time \\(T\\) \\(t\\) \\(t + w_P\\), primary event time \\(P\\) occurred sufficiently close end primary censoring window secondary even occurred time \\(t\\) end primary window. Note “Getting started” target numerical quadrature cumulative distribution function sum primary time within primary censoring window delay time.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"probability-of-secondary-event-time-within-a-secondary-censoring-window","dir":"Articles","previous_headings":"3 Statistical model used in primarycensored > 3.1 Censored delay time distribution","what":"Probability of secondary event time within a secondary censoring window","title":"Why it works","text":"constructed survival function \\(S_+\\) equation (3.1), using numerical quadrature way, can calculate probability mass secondary event time falling within observed secondary censoring window length \\(w_S\\) begins time \\(n - w_S\\) primary censoring window. probability censored delay time \\(T_c\\) \\(n\\). gives censored delay time probability integrating censored values: \\[ Pr(S_+ \\[n - w_S, n)) = Q_{S_+}(n-w_S) - Q_{S_+}(n). \\tag{3.2} \\] Note censored secondary event time can also occur within primary censoring window. happens probability, \\[ Q_{S_+}(-w_P) - Q_{S_+}(0) = 1 - Q_T(w_P) - \\int_0^{w_P} f_T(p) F_{C_P}(p) dp = Pr(T< C). \\]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"connections-to-other-approaches","dir":"Articles","previous_headings":"","what":"Connections to other approaches","title":"Why it works","text":"section, discuss approach taken primarycensored relates approaches censored data problems time event analysis.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"connection-to-park-et-al-2024","dir":"Articles","previous_headings":"4 Connections to other approaches","what":"Connection to Park et al 2024","title":"Why it works","text":"Using notation methods overview given Park et al[2], write conditional probability secondary event time \\(S\\(S_L,S_R)\\) given primary event time \\(P \\(P_L,P_R)\\) : \\[ \\begin{aligned} \\mathrm{Pr}(S_L < S < S_R | P_L < P < P_R) &= \\frac{\\mathrm{Pr}(P_L < P < P_R, S_L < S < S_R)}{\\mathrm{Pr}(P_L < P < P_R)} \\\\    &= \\frac{\\int_{P_L}^{P_R} \\int_{S_L}^{S_R} g_P(x) f_x(y-x) dy dx}{\\int_{P_L}^{P_R} g_P(x) dx}\\\\    &= \\int_{P_L}^{P_R} \\int_{S_L}^{S_R} g_P(x|P_L, P_R) f_x(y-x)dy dx \\end{aligned} \\] note, assume forward distribution doesn’t vary time (\\(f_x = f\\)), \\[ \\int_{P_L}^{P_R} \\int_{S_L}^{S_R} g_P(x|P_L, P_R) f_x(y-x)dy dx = \\int_{P_L}^{P_R} g_P(x|P_L, P_R) \\big[F(S_R - x) - F(S_L - x)\\big] dx \\] , using integration parts, get: \\[ \\begin{split} \\int_{P_L}^{P_R} g_P(x|P_L, P_R) \\big[F(S_R - x) - F(S_L - x)\\big] dx &= F(S_R - P_R) - F(S_L - P_R)  \\\\ & - \\int_{P_L}^{P_R} G_P(x|P_L, P_R) \\big[f(S_L - x) - f(S_R - x)\\big] dx \\end{split} \\tag{4.1} \\] used \\(\\partial_x F(S_R - x) = - f(S_R - x)\\) \\(\\partial_x F(S_L - x) = - f(S_L - x)\\). can now compare equation (3.2) considering following transformations: \\(P_L = -w_P\\) \\(P_R = 0\\), note treating endpoint primary censoring window origin. \\(S_L = n-w_S\\) \\(S_R = n\\), interested probability secondary event time falling within secondary censoring window \\([n, n+ w_S)\\). equation (4.1) becomes: \\[ \\begin{aligned} \\mathrm{Pr}(S_L < S < S_R | P_L < P < P_R) &= F(n) - F(n-w_S) - \\int_{-w_P}^{0} G_P(x|-w_P, 0) \\big[f(n - w_S - x) - f(n - x)\\big] dx \\end{aligned} \\] Making transformation \\(x = -p\\), rewriting notation note gives: \\[ \\begin{aligned} &= F(n) - F(n-w_S) + \\int_{w_P}^{0} G_P(-p|-w_P, 0) \\big[f_T(n - w_S + p) - f_T(n +p)\\big] dp \\\\ &= F(n) - F(n-w_S) + \\int_{0}^{w_P} G_P(-p|-w_P, 0) \\big[f_T(n + p) - f_T(n - w_S +p)\\big] dp\\\\ &= F(n) - F(n-w_S) + \\int_{0}^{w_P} (1 - F_{C_P}(p)) \\big[f_T(n + p) - f_T(n - w_S +p)\\big] dp\\\\ &= F(n + w_P) - F(n-w_S + w_P) + \\int_{0}^{w_P} [f_T(n + p - w_S) - f_T(n + p)] F_{C_P}(p) dp\\\\ &= Q_T(n-w_S + w_P) - Q_T(n + w_P) + \\int_{0}^{w_P} [f_T(n + p - w_S) - f_T(n + p)] F_{C_P}(p) dp \\\\ &= Q_{S_+}(n-w_S) - Q_{S_+}(n ). \\end{aligned} \\] equation (3.2). derivation, used \\(G_P(x|-w_P, 0)\\) distribution function time start primary interval primary event time, \\(F_{C_P}\\) distribution function time end primary event window primary event time. Therefore, \\(G_P(-p|-w_P, 0) = Pr(P < -p | P \\(-w_P, 0)) = 1 - Pr(C_P \\leq p) = 1 - F_{C_P}(p)\\).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/articles/why-it-works.html","id":"learning-more","dir":"Articles","previous_headings":"","what":"Learning more","title":"Why it works","text":"mathematical background analytic solutions see vignette(\"analytic-solutions\"). introductory explanation primary event censored distribution see vignette(\"primarycensored\").","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Sam Abbott. Author, maintainer, copyright holder. Sam Brand. Author. Adam Howes. Contributor. James Mba Azam. Author. Carl Pearson. Author. Sebastian Funk. Author. Kelly Charniga. Author.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Abbott S, Brand S, Azam J, Pearson C, Funk S, Charniga K (2025). primarycensored: Primary Event Censored Distributions. doi:10.5281/zenodo.13632839.","code":"@Manual{,   title = {primarycensored: Primary Event Censored Distributions},   author = {Sam Abbott and Sam Brand and James Mba Azam and Carl Pearson and Sebastian Funk and Kelly Charniga},   year = {2025},   doi = {10.5281/zenodo.13632839}, }"},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"summary","dir":"","previous_headings":"","what":"Summary","title":"Primary Event Censored Distributions","text":"Provides functions working primary event censored distributions ‘Stan’ implementations use Bayesian modeling. Primary event censored distributions useful modeling delayed reporting scenarios epidemiology fields (Charniga et al. (2024) doi:10.48550/arXiv.2405.08841). also provides support arbitrary delay distributions, range common primary distributions, allows truncation secondary event censoring accounted (Park et al. (2024) doi:10.1101/2024.01.12.24301247). subset common distributions also analytical solutions implemented, allowing faster computation. addition, provides multiple methods fitting primary event censored distributions data via optional dependencies.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Primary Event Censored Distributions","text":"can install latest released version CRAN using standard install.packages function: Alternatively, can install latest release r-universe repository: install development version GitHub (warning! version may contain breaking changes /bugs), use pak package: Similarly, can install historical versions specifying release tag (e.g., v0.2.0): Note: can also use approach install specific commit needed, example, want try specific unreleased feature, absolute latest developmental version. wish use Stan functions, need install CmdStan, also entails suitable C++ toolchain setup. recommend using cmdstanr package. Stan team provides instructions Getting started cmdstanr vignette, details support package site along key instructions available Stan resources package vignette, brief version : Note: can speed CmdStan installation using cores argument. installing particular version epinowcast, may also need install past version CmdStan, can version argument.","code":"install.packages(\"primarycensored\") install.packages(\"primarycensored\", repos = \"https://epinowcast.r-universe.dev\") pak::pak(\"epinowcast/primarycensored\") pak::pak(\"epinowcast/primarycensored@v0.2.0\") # if you not yet installed `primarycensored`, or you installed it without # `Suggests` dependencies install.packages(   \"cmdstanr\",   repos = c(\"https://stan-dev.r-universe.dev\", getOption(\"repos\")) ) # once `cmdstanr` is installed: cmdstanr::install_cmdstan()"},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"resources","dir":"","previous_headings":"","what":"Resources","title":"Primary Event Censored Distributions","text":"provide range documentation, case studies, community spaces ask (answer!) questions: primarycensored website includes function reference, model outline, case studies using package. site mainly concerns release version, can also find documentation latest development version. created package vignettes help get started primarycensored highlight features case studies. organisation website includes links resources, guest posts, seminar schedule upcoming past recordings. community forum areas question answer considering new methods tools, among others. generally interested real-time analysis infectious disease, may find useful even use primarycensored.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Primary Event Censored Distributions","text":"welcome contributions new contributors! particularly appreciate help identifying identified issues. Please check add issues, /add pull request see contributing guide information. need different underlying model work: primarycensored provides flexible framework censored distributions R Stan. implement new distributions censoring mechanisms expand overall flexibility improve defaults, please let us know either community forum. always like hear new use-cases extensions package.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"how-to-make-a-bug-report-or-feature-request","dir":"","previous_headings":"Contributing","what":"How to make a bug report or feature request","title":"Primary Event Censored Distributions","text":"Please briefly describe problem output expect issue. question, please don’t open issue. Instead, ask Q page. See contributing guide information.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"code-of-conduct","dir":"","previous_headings":"Contributing","what":"Code of Conduct","title":"Primary Event Censored Distributions","text":"Please note primarycensored project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Primary Event Censored Distributions","text":"making use methodology methodology based, please cite relevant papers methods outline. use primarycensored work, please consider citing citation(\"primarycensored\").","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"contributors","dir":"","previous_headings":"","what":"Contributors","title":"Primary Event Censored Distributions","text":"contributions project gratefully acknowledged using allcontributors package following -contributors specification. Contributions kind welcome!","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"code","dir":"","previous_headings":"Contributors","what":"Code","title":"Primary Event Censored Distributions","text":"seabbs, SamuelBrand1, sbfnk, athowes, jamesmbaazam, barbora-sobolova, pearsonca","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"issue-authors","dir":"","previous_headings":"Contributors","what":"Issue Authors","title":"Primary Event Censored Distributions","text":"zsusswein, jcblemai, adamkucharski","code":""},{"path":"https://primarycensored.epinowcast.org/dev/index.html","id":"issue-contributors","dir":"","previous_headings":"Contributors","what":"Issue Contributors","title":"Primary Event Censored Distributions","text":"parksw3","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/add_name_attribute.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper method for custom distributions — add_name_attribute","title":"Helper method for custom distributions — add_name_attribute","text":"pprimarycensored() related functions can identify distributions provided via pdist dprimary arguments base R functions (e.g. punif, dexp) via name attribute.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/add_name_attribute.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper method for custom distributions — add_name_attribute","text":"","code":"add_name_attribute(func, name)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/add_name_attribute.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper method for custom distributions — add_name_attribute","text":"func Function, example p- d- form distribution function. name Character string, starting \"p\" \"d\" indicating underlying distribution.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/add_name_attribute.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper method for custom distributions — add_name_attribute","text":"Function, \"name\" attribute added","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/add_name_attribute.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Helper method for custom distributions — add_name_attribute","text":"need use non-base R implementation, know distribution name, can use helper function set way detected pprimarycensored() related functions. useful enables automatic use analytical solutions distributions exist. can check analytical solutions available using methods(pcens_cdf) check distribution names using pcd_dist_name().","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/add_name_attribute.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Helper method for custom distributions — add_name_attribute","text":"","code":"dist <- add_name_attribute(pnorm, \"hello\") attr(dist, \"name\") #> [1] \"hello\""},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_dprimary.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if a function is a valid bounded probability density function (PDF) — check_dprimary","title":"Check if a function is a valid bounded probability density function (PDF) — check_dprimary","text":"function tests whether given function behaves like valid PDF checking integrates approximately 1 specified range takes arguments min max.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_dprimary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if a function is a valid bounded probability density function (PDF) — check_dprimary","text":"","code":"check_dprimary(dprimary, pwindow, dprimary_args = list(), tolerance = 0.001)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_dprimary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if a function is a valid bounded probability density function (PDF) — check_dprimary","text":"dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. pwindow Primary event window dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters tolerance tolerance integral considered close 1","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_dprimary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if a function is a valid bounded probability density function (PDF) — check_dprimary","text":"NULL. function stop execution error message dprimary valid PDF.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_dprimary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if a function is a valid bounded probability density function (PDF) — check_dprimary","text":"","code":"check_dprimary(dunif, pwindow = 1)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_pdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if a function is a valid cumulative distribution function (CDF) — check_pdist","title":"Check if a function is a valid cumulative distribution function (CDF) — check_pdist","text":"function tests whether given function behaves like valid CDF checking monotonically increasing bounded 0 1.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_pdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if a function is a valid cumulative distribution function (CDF) — check_pdist","text":"","code":"check_pdist(pdist, D, ...)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_pdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if a function is a valid cumulative distribution function (CDF) — check_pdist","text":"pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. D Maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. Defaults Inf. ... Additional arguments passed pdist","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_pdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if a function is a valid cumulative distribution function (CDF) — check_pdist","text":"NULL. function stop execution error message pdist valid CDF.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_pdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if a function is a valid cumulative distribution function (CDF) — check_pdist","text":"","code":"check_pdist(pnorm, D = 10)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_truncation.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if truncation time is appropriate relative to the maximum delay — check_truncation","title":"Check if truncation time is appropriate relative to the maximum delay — check_truncation","text":"function checks truncation time D appropriate relative maximum delay. D much larger necessary, suggests considering setting Inf better efficiency minimal accuracy cost.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_truncation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if truncation time is appropriate relative to the maximum delay — check_truncation","text":"","code":"check_truncation(delays, D, multiplier = 2)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_truncation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if truncation time is appropriate relative to the maximum delay — check_truncation","text":"delays numeric vector delay times D truncation time multiplier multiplier maximum delay compare D. Default 2.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_truncation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if truncation time is appropriate relative to the maximum delay — check_truncation","text":"Invisible NULL. Prints message condition met.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/check_truncation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if truncation time is appropriate relative to the maximum delay — check_truncation","text":"","code":"check_truncation(delays = c(1, 2, 3, 4), D = 10, multiplier = 2) #> The truncation time D (10) is larger than 2 times the maximum observed delay (4). Consider setting D to Inf for better efficiency with minimal accuracy cost for this case."},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-dpcens.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a fitdistrplus compatible wrapper around dprimarycensored — .dpcens","title":"Define a fitdistrplus compatible wrapper around dprimarycensored — .dpcens","text":"Define fitdistrplus compatible wrapper around dprimarycensored","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-dpcens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a fitdistrplus compatible wrapper around dprimarycensored — .dpcens","text":"","code":".dpcens(x, params, pdist, dprimary, dprimary_args, ...)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-dpcens.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a fitdistrplus compatible wrapper around dprimarycensored — .dpcens","text":"x Vector quantiles params data frame columns 'swindow', 'pwindow', 'D' corresponding secondary window sizes, primary window sizes, truncation times element x. pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters ... Additional arguments passed distribution function","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_function_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract base function name — .extract_function_name","title":"Extract base function name — .extract_function_name","text":"helper function extracts base name function, removing namespace prefixes.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_function_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract base function name — .extract_function_name","text":"","code":".extract_function_name(func)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_function_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract base function name — .extract_function_name","text":"func Function, example p- d- form distribution function.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_function_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract base function name — .extract_function_name","text":"Character string representing base name function.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_stan_functions.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract function names or content from Stan code — .extract_stan_functions","title":"Extract function names or content from Stan code — .extract_stan_functions","text":"Extract function names content Stan code","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_stan_functions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract function names or content from Stan code — .extract_stan_functions","text":"","code":".extract_stan_functions(content, names_only = FALSE, functions = NULL)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_stan_functions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract function names or content from Stan code — .extract_stan_functions","text":"content Character vector containing Stan code names_only Logical, TRUE extract function names, otherwise extract function content. functions Optional, character vector function names extract content .","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-extract_stan_functions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract function names or content from Stan code — .extract_stan_functions","text":"Character vector function names content","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-format_class.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract and Combine Distribution Names — .format_class","title":"Extract and Combine Distribution Names — .format_class","text":"helper function attempts determine distribution names uses establish class name potential analytical solutions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-format_class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract and Combine Distribution Names — .format_class","text":"","code":".format_class(pdist, dprimary)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-format_class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract and Combine Distribution Names — .format_class","text":"pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-format_class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract and Combine Distribution Names — .format_class","text":"character string representing combined distribution class","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-name_deprecation.html","id":null,"dir":"Reference","previous_headings":"","what":"Deprecation name helper — .name_deprecation","title":"Deprecation name helper — .name_deprecation","text":"Provides lifecycle management consistently across several functions. Currently uses lifecycle::deprecate_soft() - .e. warns used directly. future versions, switch warning unconditionally lifecycle::deprecate_warn(), throwing via lifecycle::deprecate_warn(), finally deleted along subject arguments.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-name_deprecation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Deprecation name helper — .name_deprecation","text":"","code":".name_deprecation(   pdist_name,   dprimary_name,   env = rlang::caller_env(),   user_env = rlang::caller_env(2) )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-name_deprecation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Deprecation name helper — .name_deprecation","text":"pdist_name deprecated variable check dprimary_name deprecated variable check env, user_env Pair environments define deprecate_*() called (used determine package name) function called deprecating function called (used determine deprecate_soft() message). needed calling deprecate_*() internal helper, case forward env = caller_env() user_env = caller_env(2).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-normalise_cdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalise a primary event censored CDF — .normalise_cdf","title":"Normalise a primary event censored CDF — .normalise_cdf","text":"Internal function normalise primary event censored CDF truncation applied. CDF normalised dividing value truncation point D setting values beyond D 1.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-normalise_cdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalise a primary event censored CDF — .normalise_cdf","text":"","code":".normalise_cdf(result, q, D, pcens_obj, pwindow)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-normalise_cdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalise a primary event censored CDF — .normalise_cdf","text":"result Numeric vector CDF values normalise. q Numeric vector quantiles CDF evaluated. D Numeric truncation point pcens_obj primarycensored object created new_pcens(). pwindow Secondary event window","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-normalise_cdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalise a primary event censored CDF — .normalise_cdf","text":"Normalised CDF values numeric vector","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-ppcens.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a fitdistrplus compatible wrapper around pprimarycensored — .ppcens","title":"Define a fitdistrplus compatible wrapper around pprimarycensored — .ppcens","text":"Define fitdistrplus compatible wrapper around pprimarycensored","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-ppcens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a fitdistrplus compatible wrapper around pprimarycensored — .ppcens","text":"","code":".ppcens(q, params, pdist, dprimary, dprimary_args, ...)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dot-ppcens.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a fitdistrplus compatible wrapper around pprimarycensored — .ppcens","text":"q Vector quantiles pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters ... Additional arguments passed pdist","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dprimarycensored.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the primary event censored PMF for delays — dprimarycensored","title":"Compute the primary event censored PMF for delays — dprimarycensored","text":"function computes primary event censored probability mass function (PMF) given set quantiles. adjusts PMF primary event distribution accounting delay distribution potential truncation maximum delay (D). function allows custom primary event distributions delay distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dprimarycensored.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the primary event censored PMF for delays — dprimarycensored","text":"","code":"dprimarycensored(   x,   pdist,   pwindow = 1,   swindow = 1,   D = Inf,   dprimary = stats::dunif,   dprimary_args = list(),   log = FALSE,   pdist_name = lifecycle::deprecated(),   dprimary_name = lifecycle::deprecated(),   ... )  dpcens(   x,   pdist,   pwindow = 1,   swindow = 1,   D = Inf,   dprimary = stats::dunif,   dprimary_args = list(),   log = FALSE,   pdist_name = lifecycle::deprecated(),   dprimary_name = lifecycle::deprecated(),   ... )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/dprimarycensored.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the primary event censored PMF for delays — dprimarycensored","text":"x Vector quantiles pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. pwindow Primary event window swindow Secondary event window (default: 1) D Maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. Defaults Inf. dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters log Logical; TRUE, probabilities p given log(p) pdist_name argument ignored future versions; use add_name_attribute() pdist instead dprimary_name argument ignored future versions; use add_name_attribute() dprimary instead ... Additional arguments passed distribution function","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dprimarycensored.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the primary event censored PMF for delays — dprimarycensored","text":"Vector primary event censored PMFs, normalized D finite (truncation adjustment)","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/dprimarycensored.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the primary event censored PMF for delays — dprimarycensored","text":"primary event censored PMF computed taking difference primary event censored cumulative distribution function (CDF) two points, \\(d + \\text{swindow}\\) \\(d\\). primary event censored PMF, \\(f_{\\text{cens}}(d)\\), given : $$ f_{\\text{cens}}(d) = F_{\\text{cens}}(d + \\text{swindow}) - F_{\\text{cens}}(d) $$ \\(F_{\\text{cens}}\\) primary event censored CDF. function first computes CDFs unique points (including \\(d\\) \\(d + \\text{swindow}\\)) using pprimarycensored(). creates lookup table CDFs efficiently calculate PMF input value. non-positive delays, function returns 0. finite maximum delay \\(D\\) specified, PMF normalized ensure sums 1 range [0, D]. normalization can expressed : $$ f_{\\text{cens,norm}}(d) = \\frac{f_{\\text{cens}}(d)}{\\sum_{=0}^{D-1}  f_{\\text{cens}}()} $$ \\(f_{\\text{cens,norm}}(d)\\) normalized PMF \\(f_{\\text{cens}}(d)\\) unnormalized PMF. explanation mathematical details CDF, refer documentation pprimarycensored().","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/dprimarycensored.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the primary event censored PMF for delays — dprimarycensored","text":"","code":"# Example: Weibull distribution with uniform primary events dprimarycensored(c(0.1, 0.5, 1), pweibull, shape = 1.5, scale = 2.0) #> [1] 0.1577965 0.2735269 0.3463199  # Example: Weibull distribution with exponential growth primary events dprimarycensored(   c(0.1, 0.5, 1), pweibull,   dprimary = dexpgrowth,   dprimary_args = list(r = 0.2), shape = 1.5, scale = 2.0 ) #> [1] 0.1522796 0.2691280 0.3459055"},{"path":"https://primarycensored.epinowcast.org/dev/reference/expgrowth.html","id":null,"dir":"Reference","previous_headings":"","what":"Exponential growth distribution functions — expgrowth","title":"Exponential growth distribution functions — expgrowth","text":"Density, distribution function, random generation exponential growth distribution.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/expgrowth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exponential growth distribution functions — expgrowth","text":"","code":"dexpgrowth(x, min = 0, max = 1, r, log = FALSE)  pexpgrowth(q, min = 0, max = 1, r, lower.tail = TRUE, log.p = FALSE)  rexpgrowth(n, min = 0, max = 1, r)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/expgrowth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exponential growth distribution functions — expgrowth","text":"x, q Vector quantiles. min Minimum value distribution range. Default 0. max Maximum value distribution range. Default 1. r Rate parameter exponential growth. log, log.p Logical; TRUE, probabilities p given log(p). lower.tail Logical; TRUE (default), probabilities P[X <= x], otherwise, P[X > x]. n Number observations. length(n) > 1, length taken number required.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/expgrowth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Exponential growth distribution functions — expgrowth","text":"dexpgrowth gives density, pexpgrowth gives distribution function, rexpgrowth generates random deviates. length result determined n rexpgrowth, maximum lengths numerical arguments functions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/expgrowth.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Exponential growth distribution functions — expgrowth","text":"exponential growth distribution defined interval [min, max] rate parameter (r). probability density function (PDF) : $$f(x) = \\frac{r \\cdot \\exp(r \\cdot (x - min))}{\\exp(r \\cdot max) -  \\exp(r \\cdot min)}$$ cumulative distribution function (CDF) : $$F(x) = \\frac{\\exp(r \\cdot (x - min)) - \\exp(r \\cdot min)}{  \\exp(r \\cdot max) - \\exp(r \\cdot min)}$$ random number generation, use inverse transform sampling method: Generate \\(u \\sim \\text{Uniform}(0,1)\\) Set \\(F(x) = u\\) solve \\(x\\): $$    x = min + \\frac{1}{r} \\cdot \\log(u \\cdot (\\exp(r \\cdot max) -   \\exp(r \\cdot min)) + \\exp(r \\cdot min))    $$ method works probability integral transform theorem, states \\(X\\) continuous random variable CDF \\(F(x)\\), \\(Y = F(X)\\) follows \\(\\text{Uniform}(0,1)\\) distribution. Conversely, \\(U\\) \\(\\text{Uniform}(0,1)\\) random variable, \\(F^{-1}(U)\\) distribution \\(X\\), \\(F^{-1}\\) inverse CDF. case, generate \\(u\\) \\(\\text{Uniform}(0,1)\\), solve \\(F(x) = u\\) \\(x\\) get sample exponential growth distribution. formula \\(x\\) derived algebraically solving equation: $$ u = \\frac{\\exp(r \\cdot (x - min)) - \\exp(r \\cdot min)}{\\exp(r \\cdot max) -  \\exp(r \\cdot min)} $$ \\(r\\) close 0 (\\(|r| < 1e-10\\)), distribution approximates uniform distribution [min, max], use simpler method generate samples directly uniform distribution.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/expgrowth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Exponential growth distribution functions — expgrowth","text":"","code":"x <- seq(0, 1, by = 0.1) probs <- dexpgrowth(x, r = 0.2) cumprobs <- pexpgrowth(x, r = 0.2) samples <- rexpgrowth(100, r = 0.2)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/fitdistdoublecens.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a distribution to doubly censored data — fitdistdoublecens","title":"Fit a distribution to doubly censored data — fitdistdoublecens","text":"function wraps custom approach fitting distributions doubly censored data using fitdistrplus primarycensored. handles primary censoring (primary event time known exactly), secondary censoring (secondary event time interval-censored), right truncation (events observed maximum delay).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/fitdistdoublecens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a distribution to doubly censored data — fitdistdoublecens","text":"","code":"fitdistdoublecens(   censdata,   distr,   left = \"left\",   right = \"right\",   pwindow = \"pwindow\",   D = \"D\",   dprimary = stats::dunif,   dprimary_name = lifecycle::deprecated(),   dprimary_args = list(),   truncation_check_multiplier = 2,   ... )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/fitdistdoublecens.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a distribution to doubly censored data — fitdistdoublecens","text":"censdata data frame columns 'left' 'right' representing lower upper bounds censored observations. Unlike fitdistrplus::fitdistcens() NA supported either upper lower bounds. distr character string naming distribution fitted. base name distribution corresponding d (density) p (cumulative distribution) functions available. example, use \"gamma\" (use dgamma pgamma), \"lnorm\" (dlnorm plnorm), \"weibull\", \"norm\", etc. Custom distributions can also used long corresponding d<distr>() p<distr>() functions defined loaded. left Column name lower bound observed values (default: \"left\"). right Column name upper bound observed values (default: \"right\"). pwindow Column name primary window (default: \"pwindow\"). D Column name maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. (default: \"D\"). dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary_name argument ignored future versions; use add_name_attribute() dprimary instead dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters truncation_check_multiplier Numeric multiplier use checking truncation time D appropriate relative maximum delay. Set NULL skip check. Default 2. ... Additional arguments passed fitdistrplus::fitdist().","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/fitdistdoublecens.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a distribution to doubly censored data — fitdistdoublecens","text":"object class \"fitdist\" returned fitdistrplus::fitdist.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/fitdistdoublecens.html","id":"how-distribution-functions-are-resolved","dir":"Reference","previous_headings":"","what":"How distribution functions are resolved","title":"Fit a distribution to doubly censored data — fitdistdoublecens","text":"distr parameter specifies base name distribution. function automatically looks corresponding density (d) cumulative distribution (p) functions prepending prefixes distribution name. example: distr = \"gamma\" uses dgamma() pgamma() distr = \"lnorm\" uses dlnorm() plnorm() distr = \"weibull\" uses dweibull() pweibull() distribution available base R loaded packages can used, long corresponding d<distr> p<distr> functions exist follow standard R distribution function conventions (first argument x density, q CDF).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/fitdistdoublecens.html","id":"what-this-function-does-internally","dir":"Reference","previous_headings":"","what":"What this function does internally","title":"Fit a distribution to doubly censored data — fitdistdoublecens","text":"function creates custom density CDF functions account primary censoring, secondary censoring, truncation using dprimarycensored() pprimarycensored(). custom functions passed fitdistrplus::fitdist() maximum likelihood estimation. function handles varying observation windows across observations, making suitable real-world data truncation times censoring windows may differ observations.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/fitdistdoublecens.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a distribution to doubly censored data — fitdistdoublecens","text":"","code":"# Example with normal distribution set.seed(123) n <- 1000 true_mean <- 5 true_sd <- 2 pwindow <- 2 swindow <- 2 D <- 10 samples <- rprimarycensored(   n, rnorm,   mean = true_mean, sd = true_sd,   pwindow = pwindow, swindow = swindow, D = D )  delay_data <- data.frame(   left = samples,   right = samples + swindow,   pwindow = rep(pwindow, n),   D = rep(D, n) )  fit_norm <- fitdistdoublecens(   delay_data,   distr = \"norm\",   start = list(mean = 0, sd = 1) )  summary(fit_norm) #> Fitting of the distribution ' pcens_dist ' by maximum likelihood  #> Parameters :  #>      estimate Std. Error #> mean 5.007126 0.07883554 #> sd   2.020160 0.06962184 #> Loglikelihood:  -1398.874   AIC:  2801.747   BIC:  2811.563  #> Correlation matrix: #>           mean        sd #> mean 1.0000000 0.3248076 #> sd   0.3248076 1.0000000 #>"},{"path":"https://primarycensored.epinowcast.org/dev/reference/new_pcens.html","id":null,"dir":"Reference","previous_headings":"","what":"S3 class for primary event censored distribution computation — new_pcens","title":"S3 class for primary event censored distribution computation — new_pcens","text":"S3 class primary event censored distribution computation","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/new_pcens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"S3 class for primary event censored distribution computation — new_pcens","text":"","code":"new_pcens(   pdist,   dprimary,   dprimary_args,   pdist_name = lifecycle::deprecated(),   dprimary_name = lifecycle::deprecated(),   ... )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/new_pcens.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"S3 class for primary event censored distribution computation — new_pcens","text":"pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters pdist_name argument ignored future versions; use add_name_attribute() pdist instead dprimary_name argument ignored future versions; use add_name_attribute() dprimary instead ... Additional arguments passed pdist","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/new_pcens.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"S3 class for primary event censored distribution computation — new_pcens","text":"object class pcens_{pdist_name}_{dprimary_name}. contains primary event distribution, delay distribution, delay distribution arguments, additional arguments. can used pcens_cdf() function compute primary event censored cdf.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/new_pcens.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"S3 class for primary event censored distribution computation — new_pcens","text":"","code":"new_pcens(   pdist = pgamma, dprimary = dunif, dprimary_args = list(min = 0, max = 1),   shape = 1, scale = 1 ) #> $pdist #> function (q, shape, rate = 1, scale = 1/rate, lower.tail = TRUE,  #>     log.p = FALSE)  #> { #>     if (!missing(rate) && !missing(scale)) { #>         if (abs(rate * scale - 1) < 1e-15)  #>             warning(\"specify 'rate' or 'scale' but not both\") #>         else stop(\"specify 'rate' or 'scale' but not both\") #>     } #>     .Call(C_pgamma, q, shape, scale, lower.tail, log.p) #> } #> <bytecode: 0x55a0c5e676e8> #> <environment: namespace:stats> #>  #> $dprimary #> function (x, min = 0, max = 1, log = FALSE)  #> .Call(C_dunif, x, min, max, log) #> <bytecode: 0x55a0c489bfd8> #> <environment: namespace:stats> #>  #> $dprimary_args #> $dprimary_args$min #> [1] 0 #>  #> $dprimary_args$max #> [1] 1 #>  #>  #> $args #> $args$shape #> [1] 1 #>  #> $args$scale #> [1] 1 #>  #>  #> attr(,\"class\") #> [1] \"pcens_pgamma_dunif\""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_as_stan_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for primarycensored Stan model — pcd_as_stan_data","title":"Prepare data for primarycensored Stan model — pcd_as_stan_data","text":"function takes delay data prepares use primarycensored Stan model.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_as_stan_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for primarycensored Stan model — pcd_as_stan_data","text":"","code":"pcd_as_stan_data(   data,   delay = \"delay\",   delay_upper = \"delay_upper\",   n = \"n\",   pwindow = \"pwindow\",   relative_obs_time = \"relative_obs_time\",   dist_id,   primary_id,   param_bounds,   primary_param_bounds,   priors,   primary_priors,   compute_log_lik = FALSE,   use_reduce_sum = FALSE,   truncation_check_multiplier = 2 )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_as_stan_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for primarycensored Stan model — pcd_as_stan_data","text":"data data frame containing delay data. delay Column name observed delays (default: \"delay\") delay_upper Column name upper bound delays (default: \"delay_upper\") n Column name count observations (default: \"n\") pwindow Column name primary window (default: \"pwindow\") relative_obs_time Column name relative observation time (default: \"relative_obs_time\") dist_id Integer identifying delay distribution: can use pcd_stan_dist_id() get dist ID distribution look pcd_distributions data set. primary_id Integer identifying primary distribution: can use pcd_stan_dist_id() get primary dist ID distribution (make sure select \"primary\" type) look pcd_primary_distributions data set. param_bounds list elements lower upper, numeric vector specifying bounds delay distribution parameters. primary_param_bounds list elements lower upper, numeric vector specifying bounds primary distribution parameters. priors list elements location scale, numeric vector specifying priors delay distribution parameters. primary_priors list elements location scale, numeric vector specifying priors primary distribution parameters. compute_log_lik Logical; compute log likelihood? (default: FALSE) use_reduce_sum Logical; use reduce_sum performance? (default: FALSE) truncation_check_multiplier Numeric multiplier use checking truncation time D appropriate relative maximum delay unique D value. Set NULL skip check. Default 2.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_as_stan_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for primarycensored Stan model — pcd_as_stan_data","text":"list containing data formatted use pcd_cmdstan_model()","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_as_stan_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare data for primarycensored Stan model — pcd_as_stan_data","text":"","code":"data <- data.frame(   delay = c(1, 2, 3),   delay_upper = c(2, 3, 4),   n = c(10, 20, 15),   pwindow = c(1, 1, 2),   relative_obs_time = c(10, 10, 10) ) stan_data <- pcd_as_stan_data(   data,   dist_id = 1,   primary_id = 1,   param_bounds = list(lower = c(0, 0), upper = c(10, 10)),   primary_param_bounds = list(lower = numeric(0), upper = numeric(0)),   priors = list(location = c(1, 1), scale = c(1, 1)),   primary_priors = list(location = numeric(0), scale = numeric(0)) ) #> The truncation time D (10) is larger than 2 times the maximum observed delay (3). Consider setting D to Inf for better efficiency with minimal accuracy cost for this case."},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_cmdstan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a CmdStanModel with primarycensored Stan functions — pcd_cmdstan_model","title":"Create a CmdStanModel with primarycensored Stan functions — pcd_cmdstan_model","text":"function creates CmdStanModel object using Stan model functions primarycensored optionally includes additional user-specified Stan files.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_cmdstan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a CmdStanModel with primarycensored Stan functions — pcd_cmdstan_model","text":"","code":"pcd_cmdstan_model(include_paths = primarycensored::pcd_stan_path(), ...)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_cmdstan_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a CmdStanModel with primarycensored Stan functions — pcd_cmdstan_model","text":"include_paths Character vector paths include Stan compilation. Defaults result pcd_stan_path(). ... Additional arguments passed cmdstanr::cmdstan_model().","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_cmdstan_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a CmdStanModel with primarycensored Stan functions — pcd_cmdstan_model","text":"CmdStanModel object.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_cmdstan_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a CmdStanModel with primarycensored Stan functions — pcd_cmdstan_model","text":"underlying Stan model (pcens_model.stan) supports various features: Multiple probability distributions modeling delays Primary secondary censoring Truncation Optional use reduce_sum improved performance (via within chain parallelism). Flexible prior specifications Optional computation log-likelihood model comparison","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_cmdstan_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a CmdStanModel with primarycensored Stan functions — pcd_cmdstan_model","text":"","code":"if (!is.null(cmdstanr::cmdstan_version(error_on_NA = FALSE))) {   model <- pcd_cmdstan_model(compile = FALSE)   model } #> functions { #>   #include primarycensored.stan #>   #include primarycensored_ode.stan #>   #include primarycensored_analytical_cdf.stan #>   #include expgrowth.stan #>  #>   real partial_sum(array[] int dummy, int start, int end, #>                    array[] int d, array[] int d_upper, array[] int n, #>                    array[] int pwindow, data array[] real D, #>                    int dist_id, array[] real params, #>                    int primary_id, array[] real primary_params) { #>     real partial_target = 0; #>     for (i in start:end) { #>       partial_target += n[i] * primarycensored_lpmf( #>         d[i] | dist_id, params, #>         pwindow[i], d_upper[i], D[i], #>         primary_id, primary_params #>       ); #>     } #>     return partial_target; #>   } #> } #>  #> data { #>   int<lower=0> N;  // number of observations #>   array[N] int<lower=0> d;     // observed delays #>   array[N] int<lower=0> d_upper;     // observed delays upper bound #>   array[N] int<lower=0> n;     // number of occurrences for each delay #>   array[N] int<lower=0> pwindow; // primary censoring window #>   array[N] real<lower=0> D; // maximum delay #>   int<lower=1, upper=17> dist_id; // distribution identifier #>   int<lower=1, upper=2> primary_id; // primary distribution identifier #>   int<lower=0> n_params; // number of distribution parameters #>   int<lower=0> n_primary_params; // number of primary distribution parameters #>   int<lower=0, upper=1> compute_log_lik; // whether to compute log likelihood #>   int<lower=0, upper=1> use_reduce_sum; // whether to use reduce_sum #>   vector[n_params] param_lower_bounds; // lower bounds for parameters #>   vector[n_params] param_upper_bounds; // upper bounds for parameters #>   vector[n_primary_params] primary_param_lower_bounds; // lower bounds for primary parameters #>   vector[n_primary_params] primary_param_upper_bounds; // upper bounds for primary parameters #>   array[n_params] real prior_location; // location parameters for priors #>   array[n_params] real prior_scale; // scale parameters for priors #>   array[n_primary_params] real primary_prior_location; // location parameters for primary priors #>   array[n_primary_params] real primary_prior_scale; // scale parameters for primary priors #> } #>  #> transformed data { #>   array[N] int indexes = linspaced_int_array(N, 1, N); #> } #>  #> parameters { #>   vector<lower=param_lower_bounds, upper=param_upper_bounds>[n_params] params; // distribution parameters #>   vector<lower=primary_param_lower_bounds, upper=primary_param_upper_bounds>[n_primary_params] primary_params; // primary distribution parameters #> } #>  #>  #> model { #>   // Priors #>   for (i in 1:n_params) { #>     params[i] ~ normal(prior_location[i], prior_scale[i]); #>   } #>   if (n_primary_params) { #>     for (i in 1:n_primary_params) { #>       primary_params[i] ~ normal( #>         primary_prior_location[i], #>         primary_prior_scale[i] #>       ); #>     } #>   } #>  #>   // Likelihood #>   if (use_reduce_sum) { #>     target += reduce_sum(partial_sum, indexes, 1, d, #>                          d_upper, n, pwindow, D, dist_id, to_array_1d(params), #>                          primary_id, to_array_1d(primary_params)); #>   } else { #>     for (i in 1:N) { #>       target += n[i] * primarycensored_lpmf( #>         d[i] | dist_id, to_array_1d(params), #>         pwindow[i], d_upper[i], D[i], #>         primary_id, to_array_1d(primary_params) #>       ); #>     } #>   } #> } #>  #> generated quantities { #>   vector[compute_log_lik ? N : 0] log_lik; #>   if (compute_log_lik) { #>     for (i in 1:N) { #>       log_lik[i] = primarycensored_lpmf( #>         d[i] | dist_id, to_array_1d(params), #>         pwindow[i], d_upper[i], D[i], #>         primary_id, to_array_1d(primary_params) #>       ); #>     } #>   } #> }"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_dist_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Get distribution function cdf or pdf name — pcd_dist_name","title":"Get distribution function cdf or pdf name — pcd_dist_name","text":"Get distribution function cdf pdf name","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_dist_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get distribution function cdf or pdf name — pcd_dist_name","text":"","code":"pcd_dist_name(name, type = c(\"delay\", \"primary\"))"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_dist_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get distribution function cdf or pdf name — pcd_dist_name","text":"name String. Distribution name alias type String. \"delay\" \"primary\" corresponding type distribution use look . delay pcd_distributions() used, primary pcd_primary_distributions() used.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_dist_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get distribution function cdf or pdf name — pcd_dist_name","text":"String distribution function name NA base R implementation","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_dist_name.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get distribution function cdf or pdf name — pcd_dist_name","text":"","code":"pcd_dist_name(\"lnorm\") #> [1] \"plnorm\" pcd_dist_name(\"lognormal\") #> [1] \"plnorm\" pcd_dist_name(\"gamma\") #> [1] \"pgamma\" pcd_dist_name(\"weibull\") #> [1] \"pweibull\" pcd_dist_name(\"exp\") #> [1] \"pexp\" pcd_dist_name(\"unif\", type = \"primary\") #> [1] \"dunif\" pcd_dist_name(\"expgrowth\", type = \"primary\") #> [1] \"dexpgrowth\""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_distributions.html","id":null,"dir":"Reference","previous_headings":"","what":"Supported delay distributions — pcd_distributions","title":"Supported delay distributions — pcd_distributions","text":"dataset containing information supported delay distributions primarycensored. Includes distributions base R implementations available Stan. Distributions beyond supported stan code user functions can used R code.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_distributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Supported delay distributions — pcd_distributions","text":"","code":"pcd_distributions"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_distributions.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Supported delay distributions — pcd_distributions","text":"data.frame 17 rows 4 columns: name Distribution name pdist R distribution function name (e.g. plnorm), NA base R implementation aliases Alternative names/identifiers stan_id Stan distribution ID used stan code","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_load_stan_functions.html","id":null,"dir":"Reference","previous_headings":"","what":"Load Stan functions as a string — pcd_load_stan_functions","title":"Load Stan functions as a string — pcd_load_stan_functions","text":"Load Stan functions string","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_load_stan_functions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load Stan functions as a string — pcd_load_stan_functions","text":"","code":"pcd_load_stan_functions(   functions = NULL,   stan_path = primarycensored::pcd_stan_path(),   wrap_in_block = FALSE,   write_to_file = FALSE,   output_file = \"pcd_functions.stan\" )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_load_stan_functions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load Stan functions as a string — pcd_load_stan_functions","text":"functions Character vector function names load. Defaults functions. stan_path Character string, path Stan code. Defaults path Stan code primarycensored package. wrap_in_block Logical, whether wrap functions functions{} block. Default FALSE. write_to_file Logical, whether write output file. Default FALSE. output_file Character string, path write output file write_to_file TRUE. Defaults \"pcd_functions.stan\".","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_load_stan_functions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load Stan functions as a string — pcd_load_stan_functions","text":"character string containing requested Stan functions","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_primary_distributions.html","id":null,"dir":"Reference","previous_headings":"","what":"Supported primary event distributions — pcd_primary_distributions","title":"Supported primary event distributions — pcd_primary_distributions","text":"dataset containing information supported primary event distributions primarycensored. Distributions beyond supported stan code user functions can used R code.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_primary_distributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Supported primary event distributions — pcd_primary_distributions","text":"","code":"pcd_primary_distributions"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_primary_distributions.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Supported primary event distributions — pcd_primary_distributions","text":"data.frame 2 rows 4 columns: name Distribution name dprimary R density function name aliases Alternative names/identifiers stan_id Stan distribution ID used stan code","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_dist_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Get distribution stan ID by name — pcd_stan_dist_id","title":"Get distribution stan ID by name — pcd_stan_dist_id","text":"Get distribution stan ID name","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_dist_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get distribution stan ID by name — pcd_stan_dist_id","text":"","code":"pcd_stan_dist_id(name, type = c(\"delay\", \"primary\"))"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_dist_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get distribution stan ID by name — pcd_stan_dist_id","text":"name String. Distribution name alias type String. \"delay\" \"primary\" corresponding type distribution use look . delay pcd_distributions() used, primary pcd_primary_distributions() used.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_dist_id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get distribution stan ID by name — pcd_stan_dist_id","text":"Numeric distribution ID","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_dist_id.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get distribution stan ID by name — pcd_stan_dist_id","text":"","code":"pcd_stan_dist_id(\"lnorm\") #> [1] 1 pcd_stan_dist_id(\"lognormal\") #> [1] 1 pcd_stan_dist_id(\"gamma\") #> [1] 2 pcd_stan_dist_id(\"weibull\") #> [1] 3 pcd_stan_dist_id(\"exp\") #> [1] 4 pcd_stan_dist_id(\"unif\", type = \"primary\") #> [1] 1"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Stan files containing specified functions — pcd_stan_files","title":"Get Stan files containing specified functions — pcd_stan_files","text":"function retrieves Stan files specified directory, optionally filtering files contain specific functions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Stan files containing specified functions — pcd_stan_files","text":"","code":"pcd_stan_files(functions = NULL, stan_path = primarycensored::pcd_stan_path())"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Stan files containing specified functions — pcd_stan_files","text":"functions Character vector function names search . NULL, Stan files returned. stan_path Character string specifying path directory containing Stan files. Defaults Stan path primarycensored package.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Stan files containing specified functions — pcd_stan_files","text":"character vector file paths Stan files.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_functions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Stan function names from Stan files — pcd_stan_functions","title":"Get Stan function names from Stan files — pcd_stan_functions","text":"function reads Stan files specified directory extracts names functions defined files.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_functions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Stan function names from Stan files — pcd_stan_functions","text":"","code":"pcd_stan_functions(stan_path = primarycensored::pcd_stan_path())"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_functions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Stan function names from Stan files — pcd_stan_functions","text":"stan_path Character string specifying path directory containing Stan files. Defaults Stan path primarycensored package.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_functions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Stan function names from Stan files — pcd_stan_functions","text":"character vector containing unique names functions found Stan files.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the path to the Stan code — pcd_stan_path","title":"Get the path to the Stan code — pcd_stan_path","text":"Get path Stan code","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the path to the Stan code — pcd_stan_path","text":"","code":"pcd_stan_path()"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcd_stan_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the path to the Stan code — pcd_stan_path","text":"character string path Stan code","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default method for computing primary event censored CDF — pcens_cdf.default","title":"Default method for computing primary event censored CDF — pcens_cdf.default","text":"method serves fallback combinations delay primary event distributions specific implementations. uses numeric integration method.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default method for computing primary event censored CDF — pcens_cdf.default","text":"","code":"# Default S3 method pcens_cdf(object, q, pwindow, use_numeric = FALSE)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default method for computing primary event censored CDF — pcens_cdf.default","text":"object primarycensored object created new_pcens(). q Vector quantiles pwindow Primary event window use_numeric Logical, TRUE forces use numeric integration even distributions analytical solutions. primarily useful testing purposes settings analytical solution breaks .","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default method for computing primary event censored CDF — pcens_cdf.default","text":"Vector computed primary event censored CDFs","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.default.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Default method for computing primary event censored CDF — pcens_cdf.default","text":"method implements numerical integration approach computing primary event censored CDF. uses mathematical formulation described details section pprimarycensored(), applies numerical integration instead analytical solutions.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.default.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default method for computing primary event censored CDF — pcens_cdf.default","text":"","code":"# Create a primarycensored object with gamma delay and uniform primary pcens_obj <- new_pcens(   pdist = pgamma,   dprimary = dunif,   dprimary_args = list(min = 0, max = 1),   shape = 3,   scale = 2 )  # Compute CDF for a single value pcens_cdf(pcens_obj, q = 9, pwindow = 1) #> [1] 0.7955788  # Compute CDF for multiple values pcens_cdf(pcens_obj, q = c(4, 6, 8), pwindow = 1) #> [1] 0.2564303 0.5178596 0.7221287"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute primary event censored CDF — pcens_cdf","title":"Compute primary event censored CDF — pcens_cdf","text":"function dispatches either analytical solutions (available) numerical integration via default method. see combinations analytical solutions implemented, use methods(pcens_cdf). example, pcens_cdf.gamma_unif indicates analytical solution exists gamma delay uniform primary event distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute primary event censored CDF — pcens_cdf","text":"","code":"pcens_cdf(object, q, pwindow, use_numeric = FALSE)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute primary event censored CDF — pcens_cdf","text":"object primarycensored object created new_pcens(). q Vector quantiles pwindow Primary event window use_numeric Logical, TRUE forces use numeric integration even distributions analytical solutions. primarily useful testing purposes settings analytical solution breaks .","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute primary event censored CDF — pcens_cdf","text":"Vector computed primary event censored CDFs","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pgamma_dunif.html","id":null,"dir":"Reference","previous_headings":"","what":"Method for Gamma delay with uniform primary — pcens_cdf.pcens_pgamma_dunif","title":"Method for Gamma delay with uniform primary — pcens_cdf.pcens_pgamma_dunif","text":"Method Gamma delay uniform primary","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pgamma_dunif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Method for Gamma delay with uniform primary — pcens_cdf.pcens_pgamma_dunif","text":"","code":"# S3 method for class 'pcens_pgamma_dunif' pcens_cdf(object, q, pwindow, use_numeric = FALSE)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pgamma_dunif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Method for Gamma delay with uniform primary — pcens_cdf.pcens_pgamma_dunif","text":"object primarycensored object created new_pcens(). q Vector quantiles pwindow Primary event window use_numeric Logical, TRUE forces use numeric integration even distributions analytical solutions. primarily useful testing purposes settings analytical solution breaks .","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pgamma_dunif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Method for Gamma delay with uniform primary — pcens_cdf.pcens_pgamma_dunif","text":"Vector computed primary event censored CDFs","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_plnorm_dunif.html","id":null,"dir":"Reference","previous_headings":"","what":"Method for Log-Normal delay with uniform primary — pcens_cdf.pcens_plnorm_dunif","title":"Method for Log-Normal delay with uniform primary — pcens_cdf.pcens_plnorm_dunif","text":"Method Log-Normal delay uniform primary","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_plnorm_dunif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Method for Log-Normal delay with uniform primary — pcens_cdf.pcens_plnorm_dunif","text":"","code":"# S3 method for class 'pcens_plnorm_dunif' pcens_cdf(object, q, pwindow, use_numeric = FALSE)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_plnorm_dunif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Method for Log-Normal delay with uniform primary — pcens_cdf.pcens_plnorm_dunif","text":"object primarycensored object created new_pcens(). q Vector quantiles pwindow Primary event window use_numeric Logical, TRUE forces use numeric integration even distributions analytical solutions. primarily useful testing purposes settings analytical solution breaks .","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_plnorm_dunif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Method for Log-Normal delay with uniform primary — pcens_cdf.pcens_plnorm_dunif","text":"Vector computed primary event censored CDFs","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pweibull_dunif.html","id":null,"dir":"Reference","previous_headings":"","what":"Method for Weibull delay with uniform primary — pcens_cdf.pcens_pweibull_dunif","title":"Method for Weibull delay with uniform primary — pcens_cdf.pcens_pweibull_dunif","text":"Method Weibull delay uniform primary","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pweibull_dunif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Method for Weibull delay with uniform primary — pcens_cdf.pcens_pweibull_dunif","text":"","code":"# S3 method for class 'pcens_pweibull_dunif' pcens_cdf(object, q, pwindow, use_numeric = FALSE)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pweibull_dunif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Method for Weibull delay with uniform primary — pcens_cdf.pcens_pweibull_dunif","text":"object primarycensored object created new_pcens(). q Vector quantiles pwindow Primary event window use_numeric Logical, TRUE forces use numeric integration even distributions analytical solutions. primarily useful testing purposes settings analytical solution breaks .","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_cdf.pcens_pweibull_dunif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Method for Weibull delay with uniform primary — pcens_cdf.pcens_pweibull_dunif","text":"Vector computed primary event censored CDFs","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default method for computing primary event censored quantiles — pcens_quantile.default","title":"Default method for computing primary event censored quantiles — pcens_quantile.default","text":"method inverts primary event censored CDF using numerical optimisation via optim. probability value, searches delay CDF computed pcens_cdf() approximates target probability.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default method for computing primary event censored quantiles — pcens_quantile.default","text":"","code":"# Default S3 method pcens_quantile(   object,   p,   pwindow,   D = Inf,   use_numeric = FALSE,   init = 5,   tol = 1e-08,   max_iter = 10000,   ... )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default method for computing primary event censored quantiles — pcens_quantile.default","text":"object primarycensored object created new_pcens(). p vector probabilities compute quantiles. pwindow Primary event window D Maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. Defaults Inf. use_numeric Logical; TRUE forces use numeric inversion even analytical solution available (yet implemented). init Initial guess delay. default, 5. tol Numeric tolerance convergence criterion optimisation routine. max_iter Integer specifying maximum number iterations allowed optimisation. ... Additional arguments passed underlying functions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default method for computing primary event censored quantiles — pcens_quantile.default","text":"numeric vector containing computed primary event censored quantiles.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.default.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Default method for computing primary event censored quantiles — pcens_quantile.default","text":"quantile computed minimising squared difference computed CDF target probability.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.default.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default method for computing primary event censored quantiles — pcens_quantile.default","text":"","code":"# Create a primarycensored object with gamma delay and uniform primary pcens_obj <- new_pcens(   pdist = pgamma,   dprimary = dunif,   dprimary_args = list(min = 0, max = 1),   shape = 3,   scale = 2 )  # Compute quantile for a single probability pcens_quantile(pcens_obj, p = 0.8, pwindow = 1) #> [1] 9.069147  # Compute quantiles for multiple probabilities pcens_quantile(pcens_obj, p = c(0.25, 0.5, 0.75), pwindow = 1) #> [1] 3.951257 5.853359 8.351001  # Compute quantiles for multiple probabilities with truncation pcens_quantile(pcens_obj, p = c(0.25, 0.5, 0.75), pwindow = 1, D = 10) #> [1] 3.666380 5.270768 7.092987"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute primary event censored quantiles — pcens_quantile","title":"Compute primary event censored quantiles — pcens_quantile","text":"function inverts primary event censored CDF compute quantiles. uses numerical optimisation via optim find value q pcens_cdf() close specified probability. Currently, default numerical inversion method implemented. Future analytical solutions may added.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute primary event censored quantiles — pcens_quantile","text":"","code":"pcens_quantile(object, p, pwindow, D = Inf, use_numeric = FALSE, ...)"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute primary event censored quantiles — pcens_quantile","text":"object primarycensored object created new_pcens(). p vector probabilities compute quantiles. pwindow Primary event window D Maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. Defaults Inf. use_numeric Logical; TRUE forces use numeric inversion even analytical solution available (yet implemented). ... Additional arguments passed pdist","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pcens_quantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute primary event censored quantiles — pcens_quantile","text":"Vector primary event censored quantiles.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pprimarycensored.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the primary event censored CDF for delays — pprimarycensored","title":"Compute the primary event censored CDF for delays — pprimarycensored","text":"function computes primary event censored cumulative distribution function (CDF) given set quantiles. adjusts CDF primary event distribution accounting delay distribution potential truncation maximum delay (D). function allows custom primary event distributions delay distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pprimarycensored.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the primary event censored CDF for delays — pprimarycensored","text":"","code":"pprimarycensored(   q,   pdist,   pwindow = 1,   D = Inf,   dprimary = stats::dunif,   dprimary_args = list(),   pdist_name = lifecycle::deprecated(),   dprimary_name = lifecycle::deprecated(),   ... )  ppcens(   q,   pdist,   pwindow = 1,   D = Inf,   dprimary = stats::dunif,   dprimary_args = list(),   pdist_name = lifecycle::deprecated(),   dprimary_name = lifecycle::deprecated(),   ... )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/pprimarycensored.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the primary event censored CDF for delays — pprimarycensored","text":"q Vector quantiles pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. pwindow Primary event window D Maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. Defaults Inf. dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters pdist_name argument ignored future versions; use add_name_attribute() pdist instead dprimary_name argument ignored future versions; use add_name_attribute() dprimary instead ... Additional arguments passed pdist","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pprimarycensored.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the primary event censored CDF for delays — pprimarycensored","text":"Vector primary event censored CDFs, normalized D finite (truncation adjustment)","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/pprimarycensored.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the primary event censored CDF for delays — pprimarycensored","text":"primary event censored CDF computed integrating product delay distribution function (CDF) primary event distribution function (PDF) primary event window. integration adjusted truncation finite maximum delay (D) specified. primary event censored CDF, \\(F_{\\text{cens}}(q)\\), given : $$ F_{\\text{cens}}(q) = \\int_{0}^{pwindow} F(q - p) \\cdot f_{\\text{primary}}(p) \\, dp $$ \\(F\\) CDF delay distribution, \\(f_{\\text{primary}}\\) PDF primary event times, \\(pwindow\\) primary event window. maximum delay \\(D\\) finite, CDF normalized dividing \\(F_{\\text{cens}}(D)\\): $$ F_{\\text{cens,norm}}(q) = \\frac{F_{\\text{cens}}(q)}{F_{\\text{cens}}(D)} $$ \\(F_{\\text{cens,norm}}(q)\\) normalized CDF. function creates primarycensored object using new_pcens() computes primary event censored CDF using pcens_cdf(). abstraction allows automatic use analytical solutions available, seamlessly falling back numerical integration necessary. See methods(pcens_cdf) combinations analytical solutions implemented.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/pprimarycensored.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the primary event censored CDF for delays — pprimarycensored","text":"","code":"# Example: Lognormal distribution with uniform primary events pprimarycensored(c(0.1, 0.5, 1), plnorm, meanlog = 0, sdlog = 1) #> [1] 0.0002753888 0.0475094632 0.2384217081  # Example: Lognormal distribution with exponential growth primary events pprimarycensored(   c(0.1, 0.5, 1), plnorm,   dprimary = dexpgrowth,   dprimary_args = list(r = 0.2), meanlog = 0, sdlog = 1 ) #> [1] 0.0002496934 0.0440815583 0.2290795695"},{"path":"https://primarycensored.epinowcast.org/dev/reference/primarycensored-package.html","id":null,"dir":"Reference","previous_headings":"","what":"primarycensored: Primary Event Censored Distributions — primarycensored-package","title":"primarycensored: Primary Event Censored Distributions — primarycensored-package","text":"Provides functions working primary event censored distributions 'Stan' implementations use Bayesian modeling. Primary event censored distributions useful modeling delayed reporting scenarios epidemiology fields (Charniga et al. (2024) doi:10.48550/arXiv.2405.08841 ). also provides support arbitrary delay distributions, range common primary distributions, allows truncation secondary event censoring accounted (Park et al. (2024) doi:10.1101/2024.01.12.24301247 ). subset common distributions also analytical solutions implemented, allowing faster computation. addition, provides multiple methods fitting primary event censored distributions data via optional dependencies.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/primarycensored-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"primarycensored: Primary Event Censored Distributions — primarycensored-package","text":"Maintainer: Sam Abbott contact@samabbott.co.uk (ORCID) [copyright holder] Authors: Sam Brand usi1@cdc.gov (ORCID) James Mba Azam james.azam@lshtm.ac.uk (ORCID) Carl Pearson carl.ab.pearson@gmail.com (ORCID) Sebastian Funk sebastian.funk@lshtm.ac.uk (ORCID) Kelly Charniga kelly.charniga@gmail.com (ORCID) contributors: Adam Howes adamthowes@gmail.com (ORCID) [contributor]","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/qprimarycensored.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute quantiles corresponding to target probabilities for primary event censored delays — qprimarycensored","title":"Compute quantiles corresponding to target probabilities for primary event censored delays — qprimarycensored","text":"function computes quantiles (delay values) correspond specified probabilities primary event censored distribution. given probability p, computes delay value q cumulative probability q equals p primary event censored distribution. distribution accounts delay distribution primary event timing distribution.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/qprimarycensored.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute quantiles corresponding to target probabilities for primary event censored delays — qprimarycensored","text":"","code":"qprimarycensored(   p,   pdist,   pwindow = 1,   D = Inf,   dprimary = stats::dunif,   dprimary_args = list(),   ... )  qpcens(   p,   pdist,   pwindow = 1,   D = Inf,   dprimary = stats::dunif,   dprimary_args = list(),   ... )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/qprimarycensored.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute quantiles corresponding to target probabilities for primary event censored delays — qprimarycensored","text":"p Vector probabilities 0 1 compute corresponding quantiles pdist Distribution function (CDF). package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. pwindow Primary event window D Maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. Defaults Inf. dprimary Function generate probability density function (PDF) primary event times. function take value x pwindow parameter, return probability density. normalized integrate 1 [0, pwindow]. Defaults uniform distribution [0, pwindow]. Users can provide custom functions use helper functions like dexpgrowth exponential growth distribution. See pcd_primary_distributions() examples. package can identify base R distributions potential analytical solutions. non-base R functions, users can apply add_name_attribute() yield properly tagged functions wish leverage analytical solutions. dprimary_args List additional arguments passed dprimary. example, using dexpgrowth, pass list(min = 0, max = pwindow, r = 0.2) set minimum, maximum, rate parameters ... Additional arguments passed pdist","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/qprimarycensored.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute quantiles corresponding to target probabilities for primary event censored delays — qprimarycensored","text":"Vector delay values (quantiles) corresponding input probabilities","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/qprimarycensored.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute quantiles corresponding to target probabilities for primary event censored delays — qprimarycensored","text":"probability, function finds delay value proportion events occurred time primary event censored distribution. done inverting cumulative distribution function. function creates primarycensored object using new_pcens() computes quantiles using pcens_quantile(). approach allows analytical solutions available, falling back numerical methods necessary. example, p = 0.5, function returns median delay - value 50% censored events occur time 50% occur . See methods(pcens_quantile) combinations analytical solutions implemented.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/qprimarycensored.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute quantiles corresponding to target probabilities for primary event censored delays — qprimarycensored","text":"","code":"# Compute delays where 25%, 50%, and 75% of events occur by (quartiles) # Using lognormal delays with uniform primary events qprimarycensored(c(0.25, 0.5, 0.75), plnorm, meanlog = 0, sdlog = 1) #> [1] 1.022948 1.540771 2.498358  # Same quartiles but with exponential growth in primary events qprimarycensored(   c(0.25, 0.5, 0.75), plnorm,   dprimary = dexpgrowth,   dprimary_args = list(r = 0.2), meanlog = 0, sdlog = 1 ) #> [1] 0.000000 1.557111 2.514701  # Same quartiles but with truncation at 10 qprimarycensored(   c(0.25, 0.5, 0.75), plnorm,   dprimary = dexpgrowth,   dprimary_args = list(r = 0.2), meanlog = 0, sdlog = 1, D = 10 ) #> [1] 0.000000 1.541789 2.459511"},{"path":"https://primarycensored.epinowcast.org/dev/reference/rprimarycensored.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate random samples from a primary event censored distribution — rprimarycensored","title":"Generate random samples from a primary event censored distribution — rprimarycensored","text":"function generates random samples primary event censored distribution. adjusts distribution accounting primary event distribution potential truncation maximum delay (D). function allows custom primary event distributions delay distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/rprimarycensored.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate random samples from a primary event censored distribution — rprimarycensored","text":"","code":"rprimarycensored(   n,   rdist,   pwindow = 1,   swindow = 1,   D = Inf,   rprimary = stats::runif,   rprimary_args = list(),   oversampling_factor = 1.2,   ... )  rpcens(   n,   rdist,   pwindow = 1,   swindow = 1,   D = Inf,   rprimary = stats::runif,   rprimary_args = list(),   oversampling_factor = 1.2,   ... )"},{"path":"https://primarycensored.epinowcast.org/dev/reference/rprimarycensored.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate random samples from a primary event censored distribution — rprimarycensored","text":"n Number random samples generate. rdist Function generate random samples delay distribution example stats::rlnorm() lognormal distribution. pwindow Primary event window swindow Integer specifying window size rounding delay (default 1). swindow = 0 rounding applied. D Maximum delay (truncation point). finite, distribution truncated D. set Inf, truncation applied. Defaults Inf. rprimary Function generate random samples primary distribution (default stats::runif()). rprimary_args List additional arguments passed rprimary. oversampling_factor Factor oversample number samples account truncation (default 1.2). ... Additional arguments passed distribution function.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/rprimarycensored.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate random samples from a primary event censored distribution — rprimarycensored","text":"Vector random samples primary event censored distribution censored secondary event window.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/reference/rprimarycensored.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate random samples from a primary event censored distribution — rprimarycensored","text":"mathematical formulation generating random samples primary event censored distribution follows: Generate primary event times (p) specified primary event distribution (f_p) parameters phi, defined 0 primary event window (pwindow): $$p \\sim f_p(\\phi), \\quad p \\[0, pwindow]$$ Generate delays (d) specified delay distribution (f_d) parameters theta: $$d \\sim f_d(\\theta)$$ Calculate total delays (t) adding primary event times delays: $$t = p + d$$ Apply truncation (.e. remove delays fall outside observation window) ensure delays within specified range [0, D], D maximum observable delay: $$t_{truncated} = \\{t \\mid 0 \\leq t < D\\}$$ Round truncated delays nearest secondary event window (swindow): $$t_{valid} = \\lfloor \\frac{t_{truncated}}{swindow} \\rfloor      \\times swindow$$ function oversamples account potential truncation generates additional samples needed reach desired number valid samples.","code":""},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/reference/rprimarycensored.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate random samples from a primary event censored distribution — rprimarycensored","text":"","code":"# Example: Lognormal distribution with uniform primary events rprimarycensored(10, rlnorm, meanlog = 0, sdlog = 1) #>  [1] 2 3 0 2 1 0 0 1 2 1  # Example: Lognormal distribution with exponential growth primary events rprimarycensored(   10, rlnorm,   rprimary = rexpgrowth, rprimary_args = list(r = 0.2),   meanlog = 0, sdlog = 1 ) #>  [1] 0 0 2 2 1 1 0 1 1 0"},{"path":[]},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"documentation-development-version","dir":"Changelog","previous_headings":"","what":"Documentation","title":"primarycensored (development version)","text":"Expanded function description explain primary censoring, secondary censoring, truncation. Added detailed @details sections explaining distribution names resolved (e.g., \"gamma\" uses dgamma() pgamma()), function internally. Enhanced distr parameter documentation examples guidance custom distributions. Added “learn” “might adapt vignette” sections fitdistrplus Stan fitting vignettes help users understand learning objectives adapt examples data.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"tests-development-version","dir":"Changelog","previous_headings":"","what":"Tests","title":"primarycensored (development version)","text":"Added tests verify pcd_as_stan_data() fitdistdoublecens() correctly handle data frames additional columns beyond required. (#213)","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"bug-fixes-development-version","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"primarycensored (development version)","text":"Fixed issue dprimarycensored() return small negative values (e.g., -2.2e-16) due floating-point precision computing PMF CDF differences. PMF values now clamped non-negative. (#238) Added bounds checking pcens_cdf() methods ensure CDF values always [0, 1], complementing existing upper bound check lower bound check.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-120","dir":"Changelog","previous_headings":"","what":"primarycensored 1.2.0","title":"primarycensored 1.2.0","text":"CRAN release: 2025-06-09 minor release adds quantile functions primary censored distributions enhances fitdistdoublecens() function support varying primary censoring windows truncation times. release also improves documentation, particularly Stan reference, making easier users navigate work Stan code.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-1-2-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 1.2.0","text":"pcens_quantile(): Core implementation using numerical optimisation find quantiles inverting CDF. implementation allows analytical solutions added future versions using interface pcens_cdf(). qpcens() qprimarycensored(): Convenient wrapper functions provide alternative interfaces pcens_quantile(). Added support fitdistdoublecens() allow varying primary censoring windows truncation times. part refactor interface also improved allow flexible data input.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"documentation-1-2-0","dir":"Changelog","previous_headings":"","what":"Documentation","title":"primarycensored 1.2.0","text":"Removed authorship vignettes. Updated fitdistrplus vignette use complex data relative observation time constant. Also removed note fitdistdoublecens() function limited single primary censoring windows truncation time longer case. Stan Reference enhanced make easier navigate Stan code.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-110","dir":"Changelog","previous_headings":"","what":"primarycensored 1.1.0","title":"primarycensored 1.1.0","text":"CRAN release: 2025-02-10 minor release improves documentation internal system used automatically discover analytical solutions. also adds lookups supported supported distributions tooling working lookups. makes easier package developers using primarycensored also makes easier work Stan likelihood functions improving discoverability distribution functions. Minor bugs also fixed.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-1-1-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 1.1.0","text":"Updated CI stan code also tested Windows Mac. ensure stan code compatible platforms response CI bug epidist. Revised approach automatic discovery distribution functions. soft deprecates pdist_name dprimary_name arguments throughout. Users wishing pass distribution names (.e. potentially leverage analytical solutions) advised use newly introduced add_name_attribute() function. Adds transient dependency lifecycle rlang packages. See #188 @pearsonca. Added pcd_stan_dist_id() allow discovery distribution IDs Stan models. Added pcd_dist_name() allow discovery distribution names R functions needed add_name_attribute(). Added documentation suggest use methods(pcens_cdf) find analytical solutions. Added new data sets pcd_distributions pcd_primary_distributions document distributions supported primarycensored.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"documentation-1-1-0","dir":"Changelog","previous_headings":"","what":"Documentation","title":"primarycensored 1.1.0","text":"Added CRAN downloads badge README. Corrected specify empty array docs primarycensored_lcdf(). documentation reviewed updated enhance readability clarity.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"bug-fixes-1-1-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"primarycensored 1.1.0","text":"Added missing @family tag pcens functions. omission resulted Weibull analytical solution visible package documentation. Added precalculation vector sizes primarycensored_cdf() stan function, avoiding errors platforms due narrowing conversions aggregate initialisation. Changed D type real pcens_model.stan order support infinite relative_obs_time. Switched using num_elements() size() stan code resolve compilation issues platforms reported @sbfnk.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-100","dir":"Changelog","previous_headings":"","what":"primarycensored 1.0.0","title":"primarycensored 1.0.0","text":"CRAN release: 2024-10-28 first major release primarycensored submitted CRAN.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-1-0-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 1.0.0","text":"Fix internal package misspelling primary_lpdf. Move “stable” lifecycle status. Added rhub checks Github Actions workflow. Added dependencies: \"hard\" R-CMD-check workflow ensure checks pass without optional dependencies. Improved handling examples use optional dependencies. Check URLs redirects. Ensure functions documented return values.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-060","dir":"Changelog","previous_headings":"","what":"primarycensored 0.6.0","title":"primarycensored 0.6.0","text":"release renames package primarycensored primarycensoredist also renames many functions remove dist name. done make package name functions consistent remove need use dist suffix. also aligns new PrimaryCensored.jl package Julia ecosystem. Aside name changes, release also adds analytical solution weibull distribution uniform primary censoring, removes need assign functions global environment fitdistdoublecens() using withr, adds check_truncation() function check truncation time larger maximum observed delay. used fitdistdoublecens() pcd_as_stan_data() ensure truncation time appropriate maximise computational efficiency.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-0-6-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 0.6.0","text":"Removed need assign functions global environment fitdistdoublecens() using withr. Added check_truncation() function check truncation time larger maximum observed delay. used fitdistdoublecens() pcd_as_stan_data() ensure truncation time appropriate maximise computational efficiency. pcd_as_cmdstan_data() renamed pcd_as_stan_data() better reflect used Stan models general rather just CmdStan models. stan code refactored folder functions within current stan folder stan model moved stan folder. paths stan code updated reflect . Added R stan implementations primary censored cdf weibull distribution uniform primary censoring. package renamed primarycensored functions use “dist” name.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"documentation-0-6-0","dir":"Changelog","previous_headings":"","what":"Documentation","title":"primarycensored 0.6.0","text":"Simplified “Analytic solutions” vignette removing verbose derivation details. Added links vignettes make easier navigate documentation. Added explicit usage pdist, dprimary, rdist, rprimary arguments getting started vignette make easier link mathematical details. Fixed error “Analytic solutions” vignette Weibull density treated zero negative delays. Split “works” vignette two separate vignettes, “works” “Analytic solutions censored delay distributions”.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-050","dir":"Changelog","previous_headings":"","what":"primarycensored 0.5.0","title":"primarycensored 0.5.0","text":"release adds new {touchstone} based benchmark suite package. also adds new “works” vignette aims give reader details primary censored distributions work. part “works” (@SamuelBrand1) found analytical solutions gamma, lognormal, weibull distributions uniform primary censoring. now implemented lognormal gamma distributions R stan code providing significant speedups fitting process (~10-20 times faster). Weibull added next release.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-0-5-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 0.5.0","text":"Add {touchstone} based benchmarks benchmarking R utility functions, fitting stan fitdistplus models. Added “works” vignette. Added R infrastructure analytical solutions via primarycensored S3 class. Added Weibull analytical solution “works” vignette. Added analytical solutions gamma lognormal distributions uniform primary censoring R stan code. Added numerical protection ensure CDFs delays greater maximum truncation exactly 1.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-040","dir":"Changelog","previous_headings":"","what":"primarycensored 0.4.0","title":"primarycensored 0.4.0","text":"release, added new package stan model fitting distributions using cmdstanr package. also added new function fitdistdoublecens() allow fitting double censored truncated data using fitdistrplus package. well functionality improvements release focuses improving stability stan model improving speed primarycensored_ode function.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-0-4-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 0.4.0","text":"Added new function fitdistdoublecens() allow fitting double censored truncated data using fitdistrplus package. Added low level tests Stan primarycensored_ode function. Rephrased stan code use ODE solver rather numerical integration method. allows much faster stable computation likelihood Added CmdStan model fitting distributions using cmdstanr package. Added helpers functions working new CmdStan model added example vignette. Added parameter recovery tests new CmdStan model tests primarycensored_lpmf function used NUTS based fitting.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-030","dir":"Changelog","previous_headings":"","what":"primarycensored 0.3.0","title":"primarycensored 0.3.0","text":"release fixes improves truncation handling across code base. also adds new vignette showcasing use primarycensored fitdistrplus packages together fit distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-0-3-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 0.3.0","text":"Updated approach truncation outside primary censored distribution integral. Improved tests compare random sampling probability mass/density functions R Stan. Improved cross-testing R Stan implementations primary censored distributions. Worked improving stability primarycensored_lpmf used NUTS based fitting (.e. Stan).","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"documentation-0-3-0","dir":"Changelog","previous_headings":"","what":"Documentation","title":"primarycensored 0.3.0","text":"@athowes improved getting started vignette catching grammar errors simplifying language. Added new vignette showcasing use primarycensored fitdistrplus packages together fit distributions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-020","dir":"Changelog","previous_headings":"","what":"primarycensored 0.2.0","title":"primarycensored 0.2.0","text":"release puts place initial documentation vignettes. also includes new primary censored distribution interface allow non-secondary event censored distributions. Development release identified numerical issues gradient evaluations primary censored distributions may lead breaking interface changes 0.3.0 Stan code.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-0-2-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 0.2.0","text":"Added support swindow = 0 rprimarycensored allow non-secondary event censored distributions. Adapted rprimarycensored truncation based primary censored distribution secondary events censored. better matches generative process. Added new Stan interface tool enable finding files functions implemented Stan code.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"documentation-0-2-0","dir":"Changelog","previous_headings":"","what":"Documentation","title":"primarycensored 0.2.0","text":"Added getting started vignette. Added vignette showcasing use package Stan code cmdstanr. Added vignette showcasing fit distributions using cmdstanr package.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"primarycensored-010","dir":"Changelog","previous_headings":"","what":"primarycensored 0.1.0","title":"primarycensored 0.1.0","text":"initial primarycensored release includes R stan tools dealing potentially truncated primary event censored delay distributions. expect current features work UI may change package matures next versions.","code":""},{"path":"https://primarycensored.epinowcast.org/dev/news/index.html","id":"package-0-1-0","dir":"Changelog","previous_headings":"","what":"Package","title":"primarycensored 0.1.0","text":"Added package skeleton. Added checking input functions. Added stan functions primary censored truncated distributions. Added R functions primary censored truncated distributions. Add R function facilitate working Stan code. Added tests primary censored truncated distributions. Added tests compare R Stan implementations. Added tests R functions facilitate working Stan code. Resolved R CMD check errors, warnings notes. Added hexsticker. Added vignette skeletons preparation 0.2.0 release.","code":""}]
