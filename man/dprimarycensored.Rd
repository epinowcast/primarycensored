% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dprimarycensored.R
\name{dprimarycensored}
\alias{dprimarycensored}
\alias{dpcens}
\title{Compute the primary event censored PMF for delays}
\usage{
dprimarycensored(
  x,
  pdist,
  pwindow = 1,
  swindow = 1,
  L = 0,
  D = Inf,
  dprimary = stats::dunif,
  dprimary_args = list(),
  log = FALSE,
  ...
)

dpcens(
  x,
  pdist,
  pwindow = 1,
  swindow = 1,
  L = 0,
  D = Inf,
  dprimary = stats::dunif,
  dprimary_args = list(),
  log = FALSE,
  ...
)
}
\arguments{
\item{x}{Vector of quantiles}

\item{pdist}{Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply \code{\link[=add_name_attribute]{add_name_attribute()}} to yield properly tagged
functions if they wish to leverage the analytical solutions.}

\item{pwindow}{Primary event window}

\item{swindow}{Secondary event window (default: 1)}

\item{L}{Minimum delay (lower truncation point). If greater than 0, the
distribution is left-truncated at L. This is useful for modelling
generation intervals where day 0 is excluded, particularly when used in
renewal models. Defaults to 0 (no left truncation).}

\item{D}{Maximum delay (upper truncation point). If finite, the distribution
is truncated at D. If set to Inf, no upper truncation is applied. Defaults
to Inf.}

\item{dprimary}{Function to generate the probability density function
(PDF) of primary event times. This function should take a value \code{x} and a
\code{pwindow} parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like \code{dexpgrowth} for an exponential growth distribution.
See \code{\link[=pcd_primary_distributions]{pcd_primary_distributions()}} for examples. The package can identify
base R distributions for potential analytical solutions. For non-base R
functions, users can apply \code{\link[=add_name_attribute]{add_name_attribute()}} to yield properly tagged
functions if they wish to leverage analytical solutions.}

\item{dprimary_args}{List of additional arguments to be passed to
dprimary. For example, when using \code{dexpgrowth}, you would
pass \code{list(min = 0, max = pwindow, r = 0.2)} to set the minimum, maximum,
and rate parameters}

\item{log}{Logical; if TRUE, probabilities p are given as log(p)}

\item{...}{Additional arguments to be passed to the distribution function}
}
\value{
Vector of primary event censored PMFs, normalized over [L, D] if
truncation is applied
}
\description{
This function computes the primary event censored probability mass function
(PMF) for a given set of quantiles. It adjusts the PMF of the primary event
distribution by accounting for the delay distribution and potential
truncation at a maximum delay (D) and minimum delay (L). The function allows
for custom primary event distributions and delay distributions.
}
\details{
The primary event censored PMF is computed by taking the difference of the
primary event censored cumulative distribution function (CDF) at two points,
\eqn{d + \text{swindow}} and \eqn{d}. The primary event censored PMF,
\eqn{f_{\text{cens}}(d)}, is given by:
\deqn{
f_{\text{cens}}(d) = F_{\text{cens}}(d + \text{swindow}) - F_{\text{cens}}(d)
}
where \eqn{F_{\text{cens}}} is the primary event censored CDF.

The function first computes the CDFs for all unique points (including both
\eqn{d} and \eqn{d + \text{swindow}}) using \code{\link[=pprimarycensored]{pprimarycensored()}}. It then
creates a lookup table for these CDFs to efficiently calculate the PMF for
each input value. For delays less than L, the function returns 0.

If truncation is applied (finite D or L > 0), the PMF is normalized to
ensure it sums to 1 over the range [L, D\). This normalization uses:
\deqn{
f_{\text{cens,norm}}(d) = \frac{f_{\text{cens}}(d)}{
  F_{\text{cens}}(D) - F_{\text{cens}}(L)}
}
where \eqn{f_{\text{cens,norm}}(d)} is the normalized PMF. For the
explanation and mathematical details of the CDF, refer to the documentation
of \code{\link[=pprimarycensored]{pprimarycensored()}}.
}
\examples{
# Example: Weibull distribution with uniform primary events
dprimarycensored(c(0.1, 0.5, 1), pweibull, shape = 1.5, scale = 2.0)

# Example: Weibull distribution with exponential growth primary events
dprimarycensored(
  c(0.1, 0.5, 1), pweibull,
  dprimary = dexpgrowth,
  dprimary_args = list(r = 0.2), shape = 1.5, scale = 2.0
)

# Example: Left-truncated distribution (e.g., for generation intervals)
dprimarycensored(1:9, pweibull, L = 1, D = 10, shape = 1.5, scale = 2.0)
}
\seealso{
Primary event censored distribution functions
\code{\link{pprimarycensored}()},
\code{\link{qprimarycensored}()},
\code{\link{rprimarycensored}()}
}
\concept{primarycensored}
